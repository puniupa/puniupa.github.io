<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>ぷにうぱ</title>
<link>https://puniupa.github.io/static/all.html</link>
<atom:link href="https://puniupa.github.io/static/all.xml" rel="self" type="application/rss+xml"/>
<description>法律家と研究者によるブログ</description>
<image>
<url>https://puniupa.github.io/assets/ぷにうぱ.jpg</url>
<title>ぷにうぱ</title>
<link>https://puniupa.github.io/static/all.html</link>
</image>
<generator>quarto-1.5.56</generator>
<lastBuildDate>Wed, 07 Aug 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>位相的機械学習――データはもはや「ただの数字」ではない――</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/AI/TDL.html</link>
  <description><![CDATA[ 




<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="なぜ位相的機械学習が必要とされたか" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="なぜ位相的機械学習が必要とされたか"><span class="header-section-number">1</span> なぜ位相的機械学習が必要とされたか？</h2>
<section id="従来手法の反省点" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="従来手法の反省点"><span class="header-section-number">1.1</span> 従来手法の反省点</h3>
<p>どうして「位相」が機械学習におけるキーワードとして再注目されているかというと，「以前の我々は，座標の取り方に関して無関心だったから」だと言える．</p>
<p>これまでの深層学習のアーキテクチャは，モデリングの対象が言語・音声・動画のどれであるかに依らず，</p>
<p><img src="https://puniupa.github.io/posts/2024/AI/Images/legacy.svg" class="img-fluid"></p>
<p>という同一のステップを辿っていた．</p>
<p>しかし，深層学習の応用先が広がっていくごとに，次のような例が見つかってきた：</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>分子は従来のように３次元座標ベクトルでモデリングするより，グラフとしてモデリングした方が良い <span class="citation" data-cites="Velickovic2023">(Veličković, 2023)</span>．<sup>1</sup></li>
<li>画像は（従来のようなテンソルだと思うより）実はグラフだと思った方が，幾何学的な情報を取り入れたモデリングができる <span class="citation" data-cites="Han+2022">(Han et al., 2022)</span>．<sup>2</sup></li>
<li>電子カルテ (EHR) は数値・文章・画像の複数のメディアを含むため，従来の機械学習の適用が困難であったが，その情報をグラフの形でまとめることで，患者の発作リスクや必要な投薬などを予想する精度が向上してきている <span class="citation" data-cites="Choi+2020">(Choi et al., 2020)</span>．</li>
<li>fMRI から取得される脳の画像データは，脳の部位の機能的な結合を意味するグラフの形でモデリングすることで，より多くの情報抽出と科学的発見の促進が可能になっている <span class="citation" data-cites="Ktena+2018">(Ktena et al., 2018)</span>．</li>
</ul>
</div>
</div>
</div>
</section>
<section id="ベクトルを超えていく" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ベクトルを超えていく"><span class="header-section-number">1.2</span> ベクトルを超えていく</h3>
<p><strong>根本的な問題は，従来のデータ解析では Euclid 空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> 以外の空間を考えてこなかったことにある</strong>．</p>
<p>それゆえ，どんなデータもまずは <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> 内に埋め込むことが考えられ，モデリング法の多様性が失われていたのだと言える．</p>
<p>画像を文字列のような系列だと捉えたり，分子を文字列としてモデリングしたりする様子は，大変に奇怪である．</p>
<section id="幾何学的深層学習" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="幾何学的深層学習"><span class="header-section-number">1.2.1</span> 幾何学的深層学習</h4>
<p>そこで <strong>幾何学的深層学習</strong> (GDL: Geometric Deep Learning) の標語の下で，従来の Euclid 空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> 以外にも，多様な空間上のデータをモデリングをする方法論が研究された．</p>
<p>これにより，「ベクトル」以外の言葉でデータを見ることが可能になったのである．</p>
<p>「ベクトル」以外の言葉として最初に探索されたものが「グラフ」であり，グラフニューラルネットワーク (GNN) が幾何学的深層学習の中心的な柱となっている．</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="よりみち（幾何学的深層学習の成果）">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
よりみち（幾何学的深層学習の成果）
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>幾何学的な語彙でデータの構造を捉える <strong>パーシステント・ホモロジー</strong> (persistent homology) という手法 <span class="citation" data-cites="Edelsbrunner+2002">(Edelsbrunner et al., 2002)</span>, <span class="citation" data-cites="Zomorodian-Carlsson2005">(Zomorodian and Carlsson, 2005)</span> を取り入れた手法が，<a href="https://drugdesigndata.org/about/grand-challenge">D3R</a> (Drug Design Data Resorce) Grand Challenge という世界規模の新薬創出コンテストにおいて，リガンドのポーズ予測や親和度推定など多くのタスクで１位を獲得した <span class="citation" data-cites="Nguyen+2019">(Nguyen et al., 2019)</span>, <span class="citation" data-cites="Nguyen+2020">(Nguyen et al., 2020)</span>．</li>
<li>光学顕微鏡による全能画像データをニューロン区画の階層に分割するタスクは従来は経験豊富な神経科学者のみの職人技であった．大量の教師ありデータを取得できるはずもないので，深層学習の応用は困難であったが，<strong>離散モース理論</strong> によりデータの構造を捉えることで，人間の 90% の正解率に迫っている <span class="citation" data-cites="Banerjee+2020">(Banerjee et al., 2020)</span>, <span class="citation" data-cites="Hu+2021">(Hu et al., 2021)</span>．</li>
</ul>
</div>
</div>
</div>
</section>
<section id="グラフを超えていく" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="グラフを超えていく"><span class="header-section-number">1.2.2</span> グラフを超えていく</h4>
<p>しかしすでに，グラフを超えていく動きの萌芽も見られる <span class="citation" data-cites="Hajij+2023">(Hajij et al., 2023)</span>．</p>
<p>そのためには，数学の言葉に注目することが肝要である．幾何学には，十数世紀以上の抽象化の蓄積があり，<a href="https://ja.wikipedia.org/wiki/複体">単体複体</a> <span class="citation" data-cites="Schaub+2022">(Schaub et al., 2022)</span> や<a href="https://ja.wikipedia.org/wiki/CW複体">胞体複体</a> <span class="citation" data-cites="Hajij+2020">(Hajij et al., 2020)</span> などの概念が，最初のとっかかりとなっている．</p>
<p><span class="citation" data-cites="Hansen-Ghrist2019">(Hansen and Ghrist, 2019)</span> では，スペクトル層理論というスペクトルグラフ理論の拡張が展開されている．</p>
</section>
</section>
<section id="位相的機械学習が目指すもの" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="位相的機械学習が目指すもの"><span class="header-section-number">1.3</span> 位相的機械学習が目指すもの</h3>
<p>以上，<strong>それぞれのデータに自然な表現を選ぶ</strong> ことが大事であることはわかっていただけただろう．</p>
<ul>
<li>創薬において，有機分子が目標のタンパク質に結合するかの判定のために，有機分子を文字列で表してトランスフォーマーに学習させる．</li>
<li>画像において，ニューロンの区画をモデリングするために，画像をグラフで表してトランスフォーマーに学習させる．</li>
</ul>
<p>という営みは，トランスフォーマーというアーキテクチャが言語（だけ）のために制作された当初の意図からすると，大変不本意である．<sup>3</sup> （機械学習の黎明期において，必要な試行錯誤であることは間違いないが，）</p>
<p>深層学習が，化学，薬学，神経科学，社会学などの各分野で真にイノベーションを産むためには，その分野にあったアーキテクチャの特定が必要である．</p>
<p>「各分野の各データに最もあったアーキテクチャは何か？」という指標を，<strong>幾何学を指導原理として与えよう</strong> というのが位相的機械学習である．</p>
<p>これにより，次の２点を達成することが目標である：</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ol type="1">
<li><strong>幾何学的なことばで</strong> データを理解する．（グラフか？）</li>
<li>データの位相的性質にあった機械学習アーキテクチャを選べる．</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="位相的機械学習のいま" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="位相的機械学習のいま"><span class="header-section-number">2</span> 位相的機械学習の「いま」</h2>
<p>位相的機械学習 (TDL) の目指すところを，各分野での成功事例で見ていこう．</p>
<section id="分子モデリング" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="分子モデリング"><span class="header-section-number">2.1</span> 分子モデリング</h3>
</section>
<section id="sars-cov-2-変異株予測" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sars-cov-2-変異株予測"><span class="header-section-number">2.2</span> SARS-CoV-2 変異株予測</h3>
<p>コロナウィルスの変異株にはオミクロン株という名前がついている．</p>
<p>実はオミクロン株にもさらに分類があり，当初の系統は BA.1 である．</p>
<p>BA.2 系統 <span class="citation" data-cites="Chen-Wei2022">(Chen and Wei, 2022)</span> と BA.4, BA.5 系統 <span class="citation" data-cites="Chen+2022">(Chen et al., 2022)</span> との登場可能性とその性質（感染力は？既存のワクチンが効くか？）を，２ヶ月以上前に「変異懸念株」として予測することに成功したのは，代数トポロジーの知見を取り入れた TDL 手法であった．</p>
<p>パーシステントホモロジーなどの代数トポロジーの手法は，分子間／分子内相互作用を記述するのに優れており，特に SARS-CoV-2 変異株の新たなスパイクタンパク質がどのような<a href="https://ja.wikipedia.org/wiki/リガンド">リガンド</a>に結合し得るかの予測に優れていた <span class="citation" data-cites="Chan+2018">(Cang, 2018)</span>．</p>
<p>SARS-CoV-2 やその変異株の迅速なワクチン開発の背後で暗躍していたのは，TDL だったのである．</p>
</section>
<section id="電子顕微鏡" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="電子顕微鏡"><span class="header-section-number">2.3</span> 電子顕微鏡</h3>
</section>
</section>




<div id="quarto-appendix" class="default"><section id="文献紹介" class="level2 appendix" data-number="3"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">3</span> 文献紹介</h2><div class="quarto-appendix-contents">

<p>サーベイかつポジションペーパー <span class="citation" data-cites="Papamarkou+2024TDL">(Papamarkou et al., 2024)</span> を大いに参考にした．</p>
<p><span class="citation" data-cites="Nguyen+2019">(Nguyen et al., 2019)</span> は，マルチスケール重みつき色つき部分グラフとパーシステント・ホモロジーを取り入れた深層学習手法により，D3R Grand Challenge 2 の stage 2 での<a href="https://drugdesigndata.org/php/d3r/gc2/combined/free-energy/index.php?component=443&amp;q=rmsd&amp;set=1&amp;partial=0">絶対自由エネルギー予測 set 1</a> において１位を獲得し，続いて Challenge 3 では 26 のタスクのうち 10 タスクで１位を獲得したことを報告している．</p>
<p>パーシステントホモロジーについて，液体シリカとアモルファスシリカの分子動力学シミュレーション結果を例に取り，パーシステント図式などの方法でデータの位相的構造を取り出している様子が <span class="citation" data-cites="大林一平2018">(大林一平, 2018)</span> で詳細に解説されている．論文としては <span class="citation" data-cites="Hiraoka+2016">(Hiraoka et al., 2016)</span>, <span class="citation" data-cites="Ichinomiya+2017">(Ichinomiya et al., 2017)</span> に対応する．同著者によるより数学的なものは <span class="citation" data-cites="大林一平2017">(大林一平, 2017)</span>．<a href="https://sites.google.com/view/hiraoka-lab/">平岡裕章研究室</a>の<a href="https://www.wpi-aimr.tohoku.ac.jp/hiraoka_labo/introduction_j.pdf">研究紹介スライド</a>も参照．</p>
<p><span class="citation" data-cites="Hansen-Ghrist2019">(Hansen and Ghrist, 2019)</span> では，スペクトル層理論という理論を展開している．これは，スペクトルグラフ理論を，一般の胞体層 (cellular sheaf) に拡張したものであるという．組み合わせ論的なグラフラプラシアンを，正則な胞体複体上の線型空間の胞体層上の Hodge ラプラシアンの特別な場合と見ることで，スペクトルデータを層のコホモロジーや胞体構造と関連づけることが出来るという．</p>
<p>グラフカーネルに関する良い日本語文献に <span class="citation" data-cites="ガラムカリ和2021">(ガラムカリ和 et al., 2021)</span> がある．</p>
</div></section><section id="個人的な-papamarkou2024tdl-の見どころ" class="level2 appendix" data-number="4"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">4</span> 個人的な <span class="citation" data-cites="Papamarkou+2024TDL">(Papamarkou et al., 2024)</span> の見どころ</h2><div class="quarto-appendix-contents">

<p>Computer Vision の分野に続いて，構造生成の分野でも Diffusion model が state of the art となったことが触れられている（<span class="citation" data-cites="Zhang+2023">(Mengchun Zhang et al., 2023)</span> も参照）：</p>
<blockquote class="blockquote">
<p>In addition to 2D and 3D computer vision, diffusion models have become the state-of-the-art in graphbased molecular generation. <span class="citation" data-cites="Papamarkou+2024TDL">(Papamarkou et al., 2024)</span></p>
</blockquote>
<p>これが <span class="citation" data-cites="Bodnar+2022">(Bodnar et al., 2022)</span> で Neural Sheaf Diffusion に発展しようとしている．これはグラフ上の層を考えることで，グラフ上に更なる幾何的構造を作り込み，データのより高次の構造を捉えることができるようにしようというものである（この枠組みでは，Graph Neural Network は自明な層を扱った場合，と相対化される）．</p>
<p>個人的には，Gauss 過程が Banach 空間の研究に応用できたこと，拡散過程が多様体やグラフの局所構造を捉えることが，単に数学的な特徴付けであることを超えて，効率的な計算手法として，計算機科学として，計算数学として発展する具体的な試みが，TDL の名前の下に総覧できる点が大変に興味深い．</p>
<blockquote class="blockquote">
<p>For example, a combination of applied category theory and TDA may lead to algorithms that automatically summarize how neural networks produce their output, making deep learning more understandable to humans. <span class="citation" data-cites="Papamarkou+2024TDL">(Papamarkou et al., 2024)</span></p>
</blockquote>
<p>ランダムウォークを用いて，単体複体の表現学習を行うという展開もある Simplex2Vec <span class="citation" data-cites="Billings+2019">(Billings et al., 2019)</span>, <span class="citation" data-cites="Schaub+2020">(Schaub et al., 2020)</span></p>
<p>TDL / GDL は初めての幾何学を指導原理としたエンジニアリングになるかもしれない．多様体を超えた一般的な幾何学的な枠組みが，層の言葉で作られるかもしれない．</p>
<p><span class="citation" data-cites="Bronstein+2021">(Bronstein et al., 2021)</span> も良い本である．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Banerjee+2020" class="csl-entry">
Banerjee, S., Magee, L., Wang, D., Li, X., Huo, B.-X., Jayakumar, J., … Mitra, P. P. (2020). <a href="https://doi.org/10.1038/s42256-020-0227-9">Semantic segmentation of microscopic neuroanatomical data by combining topological priors with encoder–decoder deep networks</a>. <em>Nature Machine Intelligence</em>, <em>2</em>(10), 585–594.
</div>
<div id="ref-Billings+2019" class="csl-entry">
Billings, J. C. W., Hu, M., Lerda, G., Medvedev, A. N., Mottes, F., Onicas, A., … Petri, G. (2019). <a href="https://arxiv.org/abs/1906.09068">Simplex2Vec embeddings for community detection in simplicial complexes</a>.
</div>
<div id="ref-Bodnar+2022" class="csl-entry">
Bodnar, C., Di Giovanni, F., Chamberlain, B., Lió, P., and Bronstein, M. (2022). <a href="https://proceedings.neurips.cc/paper_files/paper/2022/file/75c45fca2aa416ada062b26cc4fb7641-Paper-Conference.pdf">Neural sheaf diffusion: A topological perspective on heterophily and oversmoothing in GNNs</a>. In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, <em>Advances in neural information processing systems</em>,Vol. 35, pages 18527–18541. Curran Associates, Inc.
</div>
<div id="ref-Bronstein+2021" class="csl-entry">
Bronstein, M. M., Bruna, J., Cohen, T., and Veličković, P. (2021). <a href="https://geometricdeeplearning.com/">Geometric deep learning: Grids, groups, graphs, geodesics, and gauges</a>.
</div>
<div id="ref-Chan+2018" class="csl-entry">
Cang, L. A. W., Zixuan AND Mu. (2018). <a href="https://doi.org/10.1371/journal.pcbi.1005929">Representability of algebraic topology for biomolecules in machine learning based scoring and virtual screening</a>. <em>PLOS Computational Biology</em>, <em>14</em>(1), 1–44.
</div>
<div id="ref-Chen+2022" class="csl-entry">
Chen, J., Qiu, Y., Wang, R., and Wei, G.-W. (2022). <a href="https://doi.org/10.1016/j.compbiomed.2022.106262">Persistent laplacian projected omicron BA.4 and BA.5 to become new dominating variants</a>. <em>Computers in Biology and Medicine</em>, <em>151</em>, 106262.
</div>
<div id="ref-Chen-Wei2022" class="csl-entry">
Chen, J., and Wei, G.-W. (2022). <a href="https://doi.org/10.1021/acs.jpclett.2c00469">Omicron BA.2 (b.1.1.529.2): High potential for becoming the next dominant variant</a>. <em>The Journal of Physical Chemistry Letters</em>, <em>13</em>(17), 3840–3849. doi: 10.1021/acs.jpclett.2c00469.
</div>
<div id="ref-Choi+2020" class="csl-entry">
Choi, E., Xu, Z., Li, Y., Dusenberry, M., Flores, G., Xue, E., and Dai, A. (2020). <a href="https://doi.org/10.1609/aaai.v34i01.5400">Learning the graphical structure of electronic health records with graph convolutional transformer</a>. <em>Proceedings of the AAAI Conference on Artificial Intelligence</em>, <em>34</em>(01), 606–613.
</div>
<div id="ref-Edelsbrunner+2002" class="csl-entry">
Edelsbrunner, H., Letscher, D., and Zomorodian, A. (2002). <a href="https://doi.org/10.1007/s00454-002-2885-2">Topological persistence and simplification</a>. <em>Discrete &amp; Computational Geometry</em>, <em>28</em>(4), 511–533.
</div>
<div id="ref-Hajij+2020" class="csl-entry">
Hajij, M., Istvan, K., and Zamzmi, G. (2020). <a href="https://openreview.net/forum?id=6Tq18ySFpGU">Cell complex neural networks</a>. In <em>TDA <span>&amp;</span> beyond</em>.
</div>
<div id="ref-Hajij+2023" class="csl-entry">
Hajij, M., Zamzmi, G., Papamarkou, T., Miolane, N., Guzmán-Sáenz, A., Ramamurthy, K. N., … Schaub, M. T. (2023). <a href="https://arxiv.org/abs/2206.00606">Topological deep learning: Going beyond graph data</a>.
</div>
<div id="ref-Han+2022" class="csl-entry">
Han, K., Wang, Y., Guo, J., Tang, Y., and Wu, E. (2022). <a href="https://openreview.net/forum?id=htM1WJZVB2I">Vision <span>GNN</span>: An image is worth graph of nodes</a>. In A. H. Oh, A. Agarwal, D. Belgrave, and K. Cho, editors, <em>Advances in neural information processing systems</em>.
</div>
<div id="ref-Hansen-Ghrist2019" class="csl-entry">
Hansen, J., and Ghrist, R. (2019). <a href="https://doi.org/10.1007/s41468-019-00038-7">Toward a spectral theory of cellular sheaves</a>. <em>Journal of Applied and Computational Topology</em>, <em>3</em>(4), 315–358.
</div>
<div id="ref-Hiraoka+2016" class="csl-entry">
Hiraoka, Y., Nakamura, T., Hirata, A., Escolar, E. G., Matsue, K., and Nishiura, Y. (2016). <a href="https://doi.org/10.1073/pnas.1520877113">Hierarchical structures of amorphous solids characterized by persistent homology</a>. <em>Proceedings of the National Academy of Sciences</em>, <em>113</em>(26), 7035–7040.
</div>
<div id="ref-Hu+2021" class="csl-entry">
Hu, X., Wang, Y., Fuxin, L., Samaras, D., and Chen, C. (2021). <a href="https://openreview.net/forum?id=LGgdb4TS4Z">Topology-aware segmentation using discrete morse theory</a>. In <em>International conference on learning representations</em>.
</div>
<div id="ref-Ichinomiya+2017" class="csl-entry">
Ichinomiya, T., Obayashi, I., and Hiraoka, Y. (2017). <a href="https://doi.org/10.1103/PhysRevE.95.012504">Persistent homology analysis of craze formation</a>. <em>Phys. Rev. E</em>, <em>95</em>, 012504.
</div>
<div id="ref-Ktena+2018" class="csl-entry">
Ktena, S. I., Parisot, S., Ferrante, E., Rajchl, M., Lee, M., Glocker, B., and Rueckert, D. (2018). <a href="https://doi.org/10.1016/j.neuroimage.2017.12.052">Metric learning with spectral graph convolutions on brain connectivity networks</a>. <em>NeuroImage</em>, <em>169</em>, 431–442.
</div>
<div id="ref-Zhang+2023" class="csl-entry">
Mengchun Zhang, Qamar, M., Taegoo Kang, Jung, Y., Chenshuang Zhang, Bae, S.-H., and Chaoning Zhang. (2023). <a href="https://doi.org/10.13140/RG.2.2.26493.64480">A survey on graph diffusion models: Generative AI in science for molecule, protein and material</a>.
</div>
<div id="ref-Nguyen+2019" class="csl-entry">
Nguyen, D. D., Cang, Z., Wu, K., Wang, M., Cao, Y., and Wei, G.-W. (2019). <a href="https://doi.org/10.1007/s10822-018-0146-6">Mathematical deep learning for pose and binding affinity prediction and ranking in D3R grand challenges</a>. <em>Journal of Computer-Aided Molecular Design</em>, <em>33</em>(1), 71–82.
</div>
<div id="ref-Nguyen+2020" class="csl-entry">
Nguyen, D. D., Gao, K., Wang, M., and Wei, G.-W. (2020). <a href="https://doi.org/10.1007/s10822-019-00237-5">MathDL: Mathematical deep learning for D3R grand challenge 4</a>. <em>Journal of Computer-Aided Molecular Design</em>, <em>34</em>(2), 131–147.
</div>
<div id="ref-Papamarkou+2024TDL" class="csl-entry">
Papamarkou, T., Birdal, T., Bronstein, M., Carlsson, G., Curry, J., Gao, Y., … Zamzmi, G. (2024). <a href="https://arxiv.org/abs/2402.08871">Position: Topological deep learning is the new frontier for relational learning</a>.
</div>
<div id="ref-Stanford+2023" class="csl-entry">
Sanford, C., Hsu, D., and Telgarsky, M. (2023). <a href="https://openreview.net/forum?id=36DxONZ9bA">Representational strengths and limitations of transformers</a>. In <em>Thirty-seventh conference on neural information processing systems</em>.
</div>
<div id="ref-Schaub+2020" class="csl-entry">
Schaub, M. T., Benson, A. R., Horn, P., Lippner, G., and Jadbabaie, A. (2020). <a href="https://doi.org/10.1137/18M1201019">Random walks on simplicial complexes and the normalized hodge 1-laplacian</a>. <em>SIAM Review</em>, <em>62</em>(2), 353–391.
</div>
<div id="ref-Schaub+2022" class="csl-entry">
Schaub, M. T., Seby, J.-B., Frantzen, F., Roddenberry, T. M., Zhu, Y., and Segarra, S. (2022). <a href="https://doi.org/10.1007/978-3-030-91374-8_12">Signal processing on simplicial complexes</a>. In F. Battiston and G. Petri, editors, <em>Higher-order systems</em>, pages 301–328. Cham: Springer International Publishing.
</div>
<div id="ref-Velickovic2023" class="csl-entry">
Veličković, P. (2023). <a href="https://doi.org/10.1016/j.sbi.2023.102538">Everything is connected: Graph neural networks</a>. <em>Current Opinion in Structural Biology</em>, <em>79</em>, 102538.
</div>
<div id="ref-Zomorodian-Carlsson2005" class="csl-entry">
Zomorodian, A., and Carlsson, G. (2005). <a href="https://doi.org/10.1007/s00454-004-1146-y">Computing persistent homology</a>. <em>Discrete &amp; Computational Geometry</em>, <em>33</em>(2), 249–274.
</div>
<div id="ref-ガラムカリ和2021" class="csl-entry">
ガラムカリ和, 杉山麿人, OʼBray, L., Rieck, B., and Borgwardt, K. (2021). <a href="https://doi.org/10.11517/jjsai.36.4_421">グラフカーネルの進展</a>. <em>人工知能</em>, <em>36</em>(4), 421–429.
</div>
<div id="ref-大林一平2017" class="csl-entry">
大林一平. (2017). <a href="http://hdl.handle.net/2433/237190">位相的データ解析の現在（統計的モデリングと予測理論のための統合的数理研究）</a>. <em>数理解析研究所講究録</em>, <em>2057</em>, 34–50.
</div>
<div id="ref-大林一平2018" class="csl-entry">
大林一平. (2018). <a href="http://traffic.phys.cs.is.nagoya-u.ac.jp/~mstf/articles/mstf2018-01/">パーシステントホモロジーの理論と応用</a>. <em>交通流と自己駆動粒子系シンポジウム論文集</em>, <em>24</em>.
</div>
<div id="ref-船津公人+2024" class="csl-entry">
船津公人, 井上貴央, and 西川大貴. (2024). <em><a href="https://www.kindaikagaku.co.jp/book_list/detail/9784764960237/">詳解 マテリアルズインフォマティクス 有機・無機化学のための深層学習</a></em>. 近代科学社.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>有機化合物は，分枝の構造を文字列で表した SMILES 文字列や，３次元座標で原子の位置を表した MOL ファイルなどで表される <span class="citation" data-cites="船津公人+2024">(船津公人 et al., 2024)</span>．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="Han+2022">(Han et al., 2022)</span> はグラフニューラルネットワークが，Vision Transformer に画像分類や物体認識など多くのタスクで優ったことを報告している．↩︎</p></li>
<li id="fn3"><p>例えば，トランスフォーマーは２体間相互作用のモデリングには優れているが，３体間相互作用のモデリングは大変不得意である <span class="citation" data-cites="Stanford+2023">(Sanford et al., 2023)</span>．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>AI</category>
  <guid>https://puniupa.github.io/posts/2024/AI/TDL.html</guid>
  <pubDate>Wed, 07 Aug 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>うぱ GitHub 挑戦</title>
  <dc:creator>うぱ, ぷに</dc:creator>
  <link>https://puniupa.github.io/posts/2024/Blog/うぱgithub挑戦.html</link>
  <description><![CDATA[ 




<section id="すごい" class="level2" data-number="1">

<section id="元に戻したいとき" class="level3" data-number="1.1">

<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> reflog</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Git でやったことがすべてのブランチに渡って全部見える！</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># どのブランチにも HEAD@{index} ってインデックスがあるはずだから</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># やらかす前のやつを見つけて</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> reset HEAD@{index}</span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ほら、まるで魔法のタイムマシン</span></span></code></pre></div>
</section>
<section id="コミットメッセージ間違えた" class="level3" data-number="1.2">

<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--amend</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 指示に沿ってコミットメッセージを変更しよう</span></span></code></pre></div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="参考になるリンク" class="level2 appendix" data-number="2"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">2</span> 参考になるリンク</h2><div class="quarto-appendix-contents">

<ul>
<li><a href="https://dangitgit.com/ja">Dangit, Git!?!</a>：「ミスった！」「どうすれば良いの！？」というときに，痒いところに手が届く情報がまとまっているサイト</li>
<li><a href="../../../posts/2024/Tech/Git.html">ぷにの記事</a>：原理に迫ろうとしている．</li>
</ul>


</div></section></div> ]]></description>
  <category>Blog</category>
  <category>Tech</category>
  <guid>https://puniupa.github.io/posts/2024/Blog/うぱgithub挑戦.html</guid>
  <pubDate>Wed, 07 Aug 2024 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/Blog/Images/GitHub.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>武見研究室訪問</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/Brain/TakemiLab.html</link>
  <description><![CDATA[ 




<section id="ムーンショット型研究開発事業-internet-of-brains" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ムーンショット型研究開発事業-internet-of-brains"><span class="header-section-number">1</span> ムーンショット型研究開発事業 Internet of Brains</h2>
<section id="訪問先武見充晃先生" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="訪問先武見充晃先生"><span class="header-section-number">1.1</span> 訪問先：武見充晃先生</h3>
<p>武見充晃先生は，内閣府の政策である <a href="https://www8.cao.go.jp/cstp/moonshot/index.html">ムーンショット型研究開発制度</a> に採択されているプロジェクト <a href="https://brains.link/">Internet of Brains</a> の課題推進者の一人である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.jst.go.jp/moonshot/program/goal1/12_kanai.html"><img src="https://puniupa.github.io/posts/2024/Brain/Files/IoB.png" class="img-fluid figure-img" alt="画像をクリックでリンクを開く"></a></p>
<figcaption>画像をクリックでリンクを開く</figcaption>
</figure>
</div>
<p>武見先生は中でも，<a href="https://www.jst.go.jp/moonshot/program/goal1/appeal/12_kanai_ap04.html">課題４「共通基盤技術」</a>として登録されている「身体的能力と知覚能力の拡張による身体の制約からの解放」をテーマに研究を遂行している．</p>
<p>本プロジェクトの PM でもある金井良太氏は株式会社アラヤの創業者・CEO も務めている．株式会社アラヤは Brain-Machine Interface に関する最先端の R&amp;D を行っているのと同時に，AI 技術と組み合わせた「アラヤしかできない」多数のソリューションを提供している（<a href="https://www.araya.org/about/feature/">HP</a> も参照）．</p>
</section>
<section id="中目黒にある研究室" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="中目黒にある研究室"><span class="header-section-number">1.2</span> 中目黒にある研究室</h3>
<p>我々は，本研究グループがムーンショット事業で借りている，セレソ中目黒にある研究室に訪問させてもらった．</p>
<p><a href="https://www.nikkei.com/article/DGXZQOUC0595V0V00C24A2000000/">3/8/2024 の日経新聞「AI開発のアラヤ・金井良太CEO　好奇心の赴くまま究める」</a>の記事に登場する背景は，この研究室のものである．</p>
<a class="embedly-card" href="https://www.nikkei.com/article/DGXZQOUC0595V0V00C24A2000000/">AI開発のアラヤ・金井良太CEO　好奇心の赴くまま究める　NIKKEI The STYLE 「My Story」 - 日本経済新聞</a><script async="" src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
<p>武見先生は現在，慶應義塾大学の特任講師を務めており，牛場潤一教授の指導のもと研究に取り組んでいる．上の写真の背景は九州大学提供の「無限」をテーマとした芸術作品であり，牛場教授の特注品だという．</p>
</section>
</section>
<section id="trusted-bmi-ca" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="trusted-bmi-ca"><span class="header-section-number">2</span> Trusted BMI-CA</h2>
<p>武見先生は本研究プロジェクトで，AI 支援型 Trusted BMI-CA (Cybernetic Avatar) の社会実装にも取り組んでいる（<a href="https://brains.link/common-basic">HP</a>も参照）．</p>
<section id="bmi-ブレインピック" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="bmi-ブレインピック"><span class="header-section-number">2.1</span> BMI ブレインピック</h3>
<p>BMI-CA とは，AI の支援により，脳波だけでなく目線や頭の動きなどの様々なデータを綜合して，バーチャルリアリティ（VR）内のアバターを自分の思い通りに動かすための技術である．</p>
<p>これにより，従来の身体的制約から解放された交流が可能になる様子が，例えば次の BMI Brain-pic でよく表現されている：</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/74nq67wFKwI?si=4DtA_SpFqt5D0GRW" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>これは Epic Games が提供する世界的 TPS ゲーム Fortnite 内のキャラクターを３人で共同で動かし，徒競走の速さを競う e-sports 競技である．慶應義塾大学内の種々の背景を持った参加者が一堂に介して，公平に競い合うことが出来たという．</p>
</section>
<section id="事象関連脱同期-erd-event-related-desynchronization" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="事象関連脱同期-erd-event-related-desynchronization"><span class="header-section-number">2.2</span> 事象関連脱同期 (ERD: Event-Related Desynchronization)</h3>
<p>実は，このような技術を実現させるための基礎研究こそが，武見先生が注力してきた分野だと言える．</p>
<p>動画内に登場するヘッドセットは，ゲーム音をよく聴くためのものではなく，脳波を測るためのものである．</p>
<p>人間が手足や表情筋を動かすための最後の指令を脊髄に出すにあたって，脳内でまとめ役の役割を果たす部位である <strong>一次運動野</strong> はちょうどヘッドセットが当たる部分に位置する．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://bsd.neuroinf.jp/wiki/一次運動野"><img src="https://puniupa.github.io/posts/2024/Brain/Files/一次運動野.png" class="img-fluid figure-img" alt="一次運動野の位置（脳科学辞典，画像クリックでリンクを開く）"></a></p>
<figcaption>一次運動野の位置（脳科学辞典，画像クリックでリンクを開く）</figcaption>
</figure>
</div>
<p>「走ろう」「足を動かそう」と思うと，一次運動野において特定の周波数帯の脳波が抑制されるという <strong>事象関連脱同期</strong> (ERD) という現象が起こる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://doi.org/10.5687/iscie.22.199"><img src="https://puniupa.github.io/posts/2024/Brain/Files/ERD.png" class="img-fluid figure-img" alt="ERD の模式図（(高橋光 et al., 2009)，画像クリックでリンクを開く）"></a></p>
<figcaption>ERD の模式図（<span class="citation" data-cites="高橋光+2009">(高橋光 et al., 2009)</span>，画像クリックでリンクを開く）</figcaption>
</figure>
</div>
<p>事象関連脱同期は，本当に足を動かす際には必ず起こるものだが，必ずしも足を動かさずに，この脳波変調だけを起こせるかは別問題である．</p>
<p>この能力は訓練で向上する <span class="citation" data-cites="高橋光+2009">(高橋光 et al., 2009)</span> が，必ずしも健常者だから得意／苦手という訳でもなく，非常に面白い e-sports 的な競技性を加えていると言えるだろう．</p>
</section>
<section id="武見先生の研究" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="武見先生の研究"><span class="header-section-number">2.3</span> 武見先生の研究</h3>
<p>事象関連脱同期は，武見先生の専門の１つであると言えるだろう．</p>
<p>特に武見先生は，この ERD のメカニズムを解明する論文 <span class="citation" data-cites="Takemi+2013">(Takemi et al., 2013)</span> を発表している．<sup>1</sup></p>
<p>この論文では，感覚運動野上の事象関連脱同期が，一次運動野の興奮と相関する様子を電気生理学的に解明している．</p>
<p>この科学的発見が，BMI ブレインピックとサイバー・アバター (CA) の脳波による操作を支えているのである．</p>
</section>
</section>
<section id="非侵襲性脳刺激の体験" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="非侵襲性脳刺激の体験"><span class="header-section-number">3</span> 非侵襲性脳刺激の体験</h2>
<p>続いて我々は地下２階に案内され，大変貴重なことに，非侵襲性脳刺激の体験をさせていただいた．</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="Files/rTMS.mp4"></video></div>
<p>動画内で，自分は右手に種々のポーズを取らせ，その度に刺激の出方が変わることを見ている．基本的に一次運動野 (M1) への刺激は，既存の動きを促進する方向への筋運動に転換される．</p>
<p>武見先生はこの M1 への刺激の姿勢依存性を，<a href="https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%A2%E3%83%B3%E3%83%9E%E3%83%BC%E3%83%A2%E3%82%BB%E3%83%83%E3%83%88">マーモセット</a> で詳細に研究している論文を最近発表している <span class="citation" data-cites="Takemi+2024">(Takemi et al., 2024)</span>．<sup>2</sup></p>
<section id="つある非侵襲性脳刺激" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="つある非侵襲性脳刺激"><span class="header-section-number">3.1</span> ２つある非侵襲性脳刺激</h3>
<p>非侵襲性能刺激には，磁気を用いるものと電気を用いるものの２つがある <span class="citation" data-cites="眞野智生2022">(眞野智生, 2022)</span>：</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="代表的な非侵襲性の脳刺激">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
代表的な非侵襲性の脳刺激
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>rTMS (repetitive Transcranial Magnetic Stimulation)</p>
<p>磁場を発生させるために大きな装置（コンデンサー）が必要であるが，磁場であるために脳の深層まで刺激することができる．</p></li>
<li><p>tDCS (transcranical Direct Current Stimulation)</p>
<p>装置を軽量化し，携帯できるサイズにすることも可能であるが，電流を用いるため，脳の深層まで刺激することはできない．</p></li>
</ol>
</div>
</div>
</section>
<section id="sec-半球間抑制" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="sec-半球間抑制"><span class="header-section-number">3.2</span> リハビリへの応用</h3>
<p>rTMS は，磁気刺激の周波数を変えることによって，抑制的に働くか（1 Hz など），興奮性に働くか（5 Hz など）を変えることができる．</p>
<p>例えば，脳血管障害などにより脳に損傷を受けた患者は，半球間抑制のバランスが崩れるために，障害を受けていない方の脳が興奮しすぎてしまい，それが正常な回復を阻害してしまうことが起こる．</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="半球間抑制">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
半球間抑制
</div>
</div>
<div class="callout-body-container callout-body">
<p>右脳と左脳は脳梁によって相互に接続されており，互いに連絡しあっている．</p>
<p>その中でも，片方の大脳が活性化すると反対の大脳は抑制される，という関係にある（<a href="https://www.riken.jp/press/2012/20120224_2/">半球間抑制</a>）．</p>
<p>これは片方の大脳新皮質が活性化された際に，もう片方の大脳新皮質の表層に刺激が伝わるが，この刺激は GABA の放出を促し，その結果としてもう片方の神経活動が抑制されるためである <span class="citation" data-cites="Palmer+2012">(Palmer et al., 2012)</span>．</p>
</div>
</div>
<p>この状況を緩和するために，左右の脳で周波数を使い分けることで，非侵襲性脳刺激を用いたリハビリが可能である <span class="citation" data-cites="眞野智生2022">(眞野智生, 2022)</span>．</p>
<p>一方で，このような脳刺激は，非侵襲性と言えどもてんかんを誘発するリスクがある．そのため，てんかん患者に対する療法とはなり得ないという．</p>
</section>
</section>
<section id="近年の研究" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="近年の研究"><span class="header-section-number">4</span> 近年の研究</h2>
<p>武見先生とその研究グループによる最新の研究を２つ紹介する．</p>
<section id="選択的な抑制解除" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="選択的な抑制解除"><span class="header-section-number">4.1</span> 選択的な抑制解除</h3>
<p>前述の研究 <span class="citation" data-cites="Takemi+2013">(Takemi et al., 2013)</span> と近年の研究 <span class="citation" data-cites="Takemi+2018">(Takemi et al., 2018)</span> が合わさることで，</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ol type="1">
<li>運動を想起する，動かそうとする．</li>
<li>想起された <a href="https://ja.wikipedia.org/wiki/主動作筋">主動作筋</a> に対する皮質内抑制 (SICI) が選択的に減少する．<sup>3</sup></li>
<li>同時に事象関連脱同期 (ERD) が起こる（２と３は相関するが，因果は不明）．</li>
<li>ERD を検出するヘッドセットがアバターを動かすことで，あたかも随意的に動かせたかのような効果を生む．</li>
</ol>
</div>
</div>
</div>
<p>という機序が見えてきている．</p>
<p>脳卒中後の<a href="https://www.riken.jp/press/2012/20120224_2/">半球間抑制</a>（第 3.2 節）と同様に，脳の作用は直感的には「興奮」を中心にしていると思われがちであるが，「抑制」も大変重要な役割を果たしている．</p>
</section>
<section id="brain-machine-interface-bmi-sato2024" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="brain-machine-interface-bmi-sato2024"><span class="header-section-number">4.2</span> Brain-Machine Interface (BMI) <span class="citation" data-cites="Sato+2024">(Sato et al., 2024)</span></h3>
<p>武見先生に地下１階を案内してもらった際に，株式会社アラヤで行われているある研究の話を詳細に義紹介いただいた．</p>
<p>それが，<span class="citation" data-cites="Sato+2024">(Sato et al., 2024)</span> である．この研究はアラヤの <a href="https://research.araya.org/research/x-communication-team">X Communication Team</a> で行われているようである：</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/tK31gj2SyQc?si=JKf9Djv-l63RBZPN" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>この動画で描かれているように，言葉を介さずともタイピングと同じ速度で言語情報をやり取りすることを目指すプロジェクトである．</p>
<section id="アラヤの研究の概要" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="アラヤの研究の概要"><span class="header-section-number">4.2.1</span> アラヤの研究の概要</h4>
<p>動画のサムネイルにもなっている笹井俊太郎氏（アラヤ取締役）に文章を読んでもらい，その間の脳波データを集める作業を数ヶ月も続け，累計で 175 時間ものデータを収集した．</p>
<p>この脳波データと音声データとを <a href="https://openai.com/research/clip">CLIP</a> <span class="citation" data-cites="Radford+2021">(Radford et al., 2021)</span> というアーキテクチャのニューラルネットワークで学習させた．</p>
<p>その結果，175 時間ものデータがあると，脳波だけからどの単語を話そうとしているかは極めて高い精度で予測できることがわかった（全 512 単語の中のどれかを５割の確率で当てられる）．</p>
</section>
<section id="bmi-ai-はどこまで行けるか" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="bmi-ai-はどこまで行けるか"><span class="header-section-number">4.2.2</span> BMI × AI はどこまで行けるか？</h4>
<p>通常の研究では，脳波データは高々 10 時間程度しか収集せず，その場合は今回の <span class="citation" data-cites="Sato+2024">(Sato et al., 2024)</span> の方法でも 2.5% 程度の正答率しか出ないという．</p>
<p>すなわち，データの量を大きくすることで，現状の深層学習モデルを用いれば，高い精度で発話の予測が可能であることがわかった．</p>
<p>このように，データの量を増やすとある時点で驚異的に正答率が上がる現象は，深層学習においてよく観察されており，<a href="https://162348.github.io/posts/2024/Kernels/Deep2.html#%E5%90%8D%E5%89%8D%E3%81%AE%E7%94%B1%E6%9D%A5%E3%81%A8%E8%83%8C%E6%99%AF"><strong>スケーリング則</strong></a> と呼ばれている．</p>
<p>ただし，拡散模型 <span class="citation" data-cites="Salimans-Ho2022">(Salimans and Ho, 2022)</span> を用いて脳波だけから音声を直接生成しようとしても，意味のある音声は生成できなかったという．</p>
</section>
<section id="bmi-の歴史から見るアラヤの研究の新規性" class="level4" data-number="4.2.3">
<h4 data-number="4.2.3" class="anchored" data-anchor-id="bmi-の歴史から見るアラヤの研究の新規性"><span class="header-section-number">4.2.3</span> BMI の歴史から見る，アラヤの研究の新規性</h4>
<p>2017 年前後まで，300-based BMI <span class="citation" data-cites="Donchin+2000">(Donchin et al., 2000)</span> が主流であった．</p>
<p>これは <strong>スペラー</strong> (speller) と呼ばれる種のインターフェースであり，画面上で点滅する文字を注視する際の脳波を通じてタイピングをする．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="http://onishi.starfree.jp/research_BMI.html"><img src="https://puniupa.github.io/posts/2024/Brain/Files/P300_speller_s.gif" class="img-fluid figure-img" alt="P300 speller のアニメーション（大西章也氏のブログより，画像をタップでリンクを開く）"></a></p>
<figcaption>P300 speller のアニメーション（大西章也氏のブログより，画像をタップでリンクを開く）</figcaption>
</figure>
</div>
<p>このスペラーの方法で自動で照明を点灯させる <span class="citation" data-cites="神作憲司2009">(神作憲司, 2009)</span> などの応用も考えられていたが，やはり必ずモニターを用意してその点滅を注視しなければいけないことは使用者の大きなストレスになるため，広い応用は難しかっただろう．</p>
<p>脳波データのノイズ低減法が進歩したり，深層学習手法が進歩することで，175 時間もデータを集めずに済むようになったら，アラヤの研究を通じて，障害を持った人もそうでない人も隔たりなく，リアルタイムで会話ができるようになる日も近いかもしれない．</p>
</section>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="終わりに" class="level2 appendix" data-number="5"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">5</span> 終わりに</h2><div class="quarto-appendix-contents">

<p>犬やイルカと会話ができるようになる日も遠くないかもしれない．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Donchin+2000" class="csl-entry">
Donchin, E., Spencer, K. M., and Wijesinghe, R. (2000). <a href="https://doi.org/10.1109/86.847808">The mental prosthesis: Assessing the speed of a P300-based brain-computer interface</a>. <em>IEEE Transactions on Rehabilitation Engineering</em>, <em>8</em>(2), 174–179.
</div>
<div id="ref-Palmer+2012" class="csl-entry">
Palmer, L. M., Schulz, J. M., Murphy, S. C., Ledergerber, D., Murayama, M., and Larkum, M. E. (2012). <a href="https://doi.org/10.1126/science.1217276">The cellular basis of GABA&lt;sub&gt;b&lt;/sub&gt;-mediated interhemispheric inhibition</a>. <em>Science</em>, <em>335</em>(6071), 989–993.
</div>
<div id="ref-Radford+2021" class="csl-entry">
Radford, A., Kim, J. W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., … Sutskever, I. (2021). <a href="https://proceedings.mlr.press/v139/radford21a.html">Learning transferable visual models from natural language supervision</a>. In M. Meila and T. Zhang, editors, <em>Proceedings of the 38th international conference on machine learning</em>,Vol. 139, pages 8748–8763. PMLR.
</div>
<div id="ref-Salimans-Ho2022" class="csl-entry">
Salimans, T., and Ho, J. (2022). <a href="https://openreview.net/forum?id=TIdIXIpzhoI">Progressive distillation for fast sampling of diffusion models</a>. In <em>International conference on learning representations</em>.
</div>
<div id="ref-Sato+2024" class="csl-entry">
Sato, M., Tomeoka, K., Horiguchi, I., Arulkumaran, K., Kanai, R., and Sasai, S. (2024). <a href="https://arxiv.org/abs/2407.07595">Scaling law in neural data: Non-invasive speech decoding with 175 hours of EEG data</a>.
</div>
<div id="ref-Takemi+2018" class="csl-entry">
Takemi, M., Maeda, T., Masakado, Y., Siebner, H. R., and Ushiba, J. (2018). <a href="https://doi.org/10.1016/j.neuroimage.2018.08.070">Muscle-selective disinhibition of corticomotor representations using a motor imagery-based brain-computer interface</a>. <em>NeuroImage</em>, <em>183</em>, 597–605.
</div>
<div id="ref-Takemi+2013" class="csl-entry">
Takemi, M., Masakado, Y., Liu, M., and Ushiba, J. (2013). <a href="https://doi.org/10.1152/jn.01092.2012">Event-related desynchronization reflects downregulation of intracortical inhibition in human primary motor cortex</a>. <em>Journal of Neurophysiology</em>, <em>110</em>(5), 1158–1166.
</div>
<div id="ref-Takemi+2024" class="csl-entry">
Takemi, M., Tia, B., Kosugi, A., Castagnola, E., Ansaldo, A., Ricci, D., … Iriki, A. (2024). <a href="https://doi.org/10.1101/2024.01.23.576825">Posture-dependent modulation of marmoset cortical motor maps detected via rapid multichannel epidural stimulation</a>. <em>bioRxiv</em>.
</div>
<div id="ref-眞野智生2022" class="csl-entry">
眞野智生. (2022). <a href="https://doi.org/10.15082/jsnt.39.4_706">非侵襲性脳刺激を使用したニューロリハビリテーション</a>. <em>神経治療学</em>, <em>39</em>(4), 706–710.
</div>
<div id="ref-神作憲司2009" class="csl-entry">
神作憲司. (2009). <a href="https://doi.org/10.14874/jergo.45spl.0.124.0">非侵襲脳機能計測技術のブレイン-マシン・インターフェイスへの応用</a>. <em>日本人間工学会大会講演集</em>, <em>45spl</em>, 124–125.
</div>
<div id="ref-高橋光+2009" class="csl-entry">
高橋光, 郷古学, and 伊藤宏司. (2009). <a href="https://doi.org/10.5687/iscie.22.199">運動想起フィードバック訓練による事象関連脱同期 (ERD) 出現の検証</a>. <em>システム制御情報学会論文誌</em>, <em>22</em>(5), 199–205.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>武見先生の引用数最大の論文である，<a href="https://scholar.google.com/citations?user=uMraLisAAAAJ&amp;hl=en">Google Scholar</a> 参照．↩︎</p></li>
<li id="fn2"><p>ただし，<span class="citation" data-cites="Takemi+2024">(Takemi et al., 2024)</span> はマーモセットに電極を埋め込んでおり，我々が経験した非侵襲性の状況とは全く異なる．↩︎</p></li>
<li id="fn3"><p>実はこの効果は拮抗筋では見られないという <span class="citation" data-cites="Takemi+2018">(Takemi et al., 2018)</span>．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Neuroscience</category>
  <category>AI</category>
  <category>Blog</category>
  <guid>https://puniupa.github.io/posts/2024/Brain/TakemiLab.html</guid>
  <pubDate>Tue, 06 Aug 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>ffmpeg による音声・動画の変換</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/Tech/ffmpeg.html</link>
  <description><![CDATA[ 




<section id="早見表" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="早見表"><span class="header-section-number">1</span> 早見表</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
<p>で情報を表示する．</p>
<section id="動画を-.gif-に" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="動画を-.gif-に"><span class="header-section-number">1.1</span> 動画を <code>.gif</code> に</h3>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> -r 10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> gif <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>.gif</span></code></pre></div>
<ul>
<li><code>-r</code> はフレームレートを指定する．</li>
<li><code>-f</code> はフォーマットを指定する．</li>
</ul>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="注">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> input.mkv <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-vf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fps=10,scale=320:-1:flags=lanczos"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c:v</span> gif <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> gif output.gif</span></code></pre></div>
<ul>
<li><code>-vf</code> はビジュアルフィルタを指定する．
<ul>
<li><code>fps=10</code> はフレームレートを指定する．</li>
<li><code>scale=320:-1:flags=lanczos</code> はサイズを指定する．幅を 320 ピクセルとし，高さは自動調節する．</li>
<li><code>flags=lanczos</code> は <a href="https://ja.wikipedia.org/wiki/ランチョス法">Lanczos アルゴリズム</a> を用いて，アンチエイリアスを指定する．</li>
</ul></li>
<li><code>-c:v</code> はビデオコードを指定する．
<ul>
<li><code>-c:v gif</code> は出力のビデオコーデックを GIF にする．</li>
</ul></li>
<li><code>-f</code> はフォーマットを指定する．</li>
</ul>
<p>codec とは encoder と decoder のかばん語であり，圧縮と復号を司る．</p>
</div>
</div>
</div>
</section>
<section id="動画から音声へ" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="動画から音声へ"><span class="header-section-number">1.2</span> 動画から音声へ</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> -vn <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-acodec</span> copy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>output filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
<ul>
<li><code>-vn</code> は動画でないことを指定 (video not)</li>
<li><code>-acodec copy</code> は同じストリームを使うことを表す</li>
</ul>
</section>
<section id="音声を-.mp3-に" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="音声を-.mp3-に"><span class="header-section-number">1.3</span> 音声を <code>.mp3</code> に</h3>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> -acodec libmp3lame <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>.mp3</span></code></pre></div>
<ul>
<li><code>-acodec libmp3lame</code> は音声コードの指定をしている（省略可能）．</li>
</ul>
</section>
</section>
<section id="波形表示" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="波形表示"><span class="header-section-number">2</span> 波形表示</h2>
<p>音声から動画にする際に，<a href="https://qiita.com/n-taishi/items/9659dc12c1300c2f00eb">小粋なアニメーションをつけることもできる</a>．</p>
<section id="スペクトルを表示する" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="スペクトルを表示する"><span class="header-section-number">2.1</span> スペクトルを表示する</h3>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> -filter_complex <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showspectrum"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>output<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="例">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
例
</div>
</div>
<div class="callout-body-container callout-body">
<p>次の音声を変換してみると</p>
<div class="article-card-container">
  <audio controls="" style="float: center;">
    <source src="Images/example.aac" type="audio/aac">
  </audio>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showspectrum=slide=1:mode=separate:color=plasma:scale=log:saturation=1:legend=0"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> 60 output1.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output1.gif" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="種々の設定">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
種々の設定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.wav <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showwaves=split_channels=1:mode=line"</span> example_waves.gif</span></code></pre></div>
<ul>
<li><code>showwaves</code> は音声の波形を表示する．</li>
<li><code>split_channels=1</code> はチャンネルを 1 つにする．</li>
<li><code>mode=line</code> は波形の表示方法を直結びにする．</li>
</ul>
</div>
</div>
</div>
</section>
<section id="波形を表示する" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="波形を表示する"><span class="header-section-number">2.2</span> 波形を表示する</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showwaves=split_channels=1:mode=line"</span> output2.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output2.gif" class="img-fluid"></p>
</section>
<section id="音量を表示する" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="音量を表示する"><span class="header-section-number">2.3</span> 音量を表示する</h3>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showvolume"</span> output3.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output3.gif" class="img-fluid"></p>
</section>
<section id="周波数を表示する" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="周波数を表示する"><span class="header-section-number">2.4</span> 周波数を表示する</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showfreqs=mode=bar"</span> output4.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output4.gif" class="img-fluid"></p>
</section>
<section id="定-q-変換-を表示する" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="定-q-変換-を表示する"><span class="header-section-number">2.5</span> <a href="https://en.wikipedia.org/wiki/Constant-Q_transform">定 Q-変換</a> を表示する</h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showcqt"</span> output5.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output5.gif" class="img-fluid"></p>
<p>これは複素 <a href="https://en.wikipedia.org/wiki/Morlet_wavelet">Morlet ウェーブレット変換</a>とも呼ばれる変換であり，ピアノのような見た目から，音源などでよく用いられる．</p>
</section>
<section id="scalogram-を表示する" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="scalogram-を表示する"><span class="header-section-number">2.6</span> scalogram を表示する</h3>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode zsh code-with-copy"><code class="sourceCode zsh"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffmpeg</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> example.aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-filter_complex</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"showcwt=mode=channel"</span> output6.gif</span></code></pre></div>
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/output6.gif" class="img-fluid"></p>
<p>これは<a href="https://en.wikipedia.org/wiki/Continuous_wavelet_transform">連続ウェーブレット変換</a>を適用した結果を表示している．</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="参考になるリンク" class="level2 appendix" data-number="3"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">3</span> 参考になるリンク</h2><div class="quarto-appendix-contents">

<ul>
<li><a href="https://hackmd.io/@GKcnNngaSBe9qCYV54wL8g/Hk3kWiNqM">FFmpeg 基本</a>：いろんなオプションがまとまっている．</li>
<li><a href="https://qiita.com/n-taishi/items/9659dc12c1300c2f00eb">ffmpegで音声ファイルを動画に変換する</a>：多くのコードを参考にしました．</li>
<li>吉井和佳，井上昂治 (2020) 『計算機科学実験及演習 4「音響信号処理」』</li>
</ul>


</div></section></div> ]]></description>
  <category>Tech</category>
  <guid>https://puniupa.github.io/posts/2024/Tech/ffmpeg.html</guid>
  <pubDate>Thu, 18 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/Tech/Images/output4.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>生成 AI 開発企業の論点</title>
  <dc:creator>うぱ, ぷに</dc:creator>
  <link>https://puniupa.github.io/posts/2024/AI/Journalism.html</link>
  <description><![CDATA[ 




<p><a href="https://en.wikipedia.org/wiki/International_Journalism_Festival">International Journalism Festival</a> はイタリアのペルージアにて，2006 年から毎年開催されている．</p>
<section id="内部告発者の言うことを聞く準備はできているか-ijf2024" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="内部告発者の言うことを聞く準備はできているか-ijf2024"><span class="header-section-number">1</span> 内部告発者の言うことを聞く準備はできているか？ <span class="citation" data-cites="IJF2024">(Festival, 2024a)</span></h2>
<p>生成 AI 開発には大規模な計算資源とデータセットが必要であり，これらを揃えられる企業は現状数えるほどしかない．</p>
<p>そのため，必然的に大規模かつ組織的な企業に限られ，OpenAI をはじめとして情報統制が厳格であり，その内部状況は内部告発者 (whistleblower) や退職・転職者によるブログやソーシャルメディアに頼り切りになっているのが現状である．</p>
<p>仮に，社会的問題の萌芽がどこかの企業で見られようと，我々がそれを知るには，内部告発者に頼るしかない．しかし，内部告発者とは開発者に他ならず，その内容は極めて専門的であるかもしれず，我々がその発信の内容を聞き入れて，適切な行動に繋げる準備ができているとは言い難い．</p>
<p>生成 AI 開発を監視し，生じ得る問題に準備するためには，我々も出てくる情報に対して準備ができている状態でなければならない．</p>
</section>
<section id="生成-ai-を高度に活用した偽情報はどのように見抜けるか-ijf2024-disinfo" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="生成-ai-を高度に活用した偽情報はどのように見抜けるか-ijf2024-disinfo"><span class="header-section-number">2</span> 生成 AI を高度に活用した偽情報はどのように見抜けるか？ <span class="citation" data-cites="IJF2024-Disinfo">(Festival, 2024b)</span></h2>
<p>Microsoft Research が４月16日に発表したモデル <a href="https://www.microsoft.com/en-us/research/project/vasa-1/">VASA-1</a> <span class="citation" data-cites="Xu+2024">(Xu et al., 2024)</span> は，１枚の写真と音声ファイルから，あたかもその人が音声ファイルの内容を喋っているかのような動画を生成することが可能である．</p>
<p>このような，AI が生成した画像・動画等がシェアされることによって，それを見た市民の感情を引き起こすことができ，多くの場合この変化は可逆でない．</p>
<p>テクノロジー的な解決については，かなり悲観的になるべきである．完璧な AI detectors はまだできておらず，精度の低い人の目にも AI 生成であることがわかるようなものは検出できても，精度が高いものだと「AI 生成である確率は 1% である」などと出力してしまうという．</p>
<p>このような逆境の中でも <a href="https://www.truemedia.org/">TrueMedia.org</a> など，AI 生成かどうかを判定するイニシアティブが存在する．</p>
</section>
<section id="参考リンク" class="level2" data-number="3">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">3 参考リンク</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-IJF2024" class="csl-entry">
Festival, I. J. (2024a). <em><a href="https://www.journalismfestival.com/programme/2024/how-to-prepare-for-the-ai-whistleblowers">How to prepare for the AI whistleblowers?</a></em>
</div>
<div id="ref-IJF2024-Disinfo" class="csl-entry">
Festival, I. J. (2024b). <em><a href="https://www.journalismfestival.com/programme/2024/how-to-spot-ai-disinformation">How to spot AI disinformation?</a></em>
</div>
<div id="ref-Xu+2024" class="csl-entry">
Xu, S., Chen, G., Guo, Y.-X., Yang, J., Li, C., Zang, Z., … Guo, B. (2024). <a href="https://arxiv.org/abs/2404.10667">VASA-1: Lifelike audio-driven talking faces generated in real time</a>.
</div>
</div></section></div> ]]></description>
  <category>AI</category>
  <category>Disinformation</category>
  <guid>https://puniupa.github.io/posts/2024/AI/Journalism.html</guid>
  <pubDate>Tue, 16 Jul 2024 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/AI/Images/IJF.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>GitHub の使い方</title>
  <dc:creator>ぷに Draft</dc:creator>
  <link>https://puniupa.github.io/posts/2024/Tech/Git.html</link>
  <description><![CDATA[ 




<section id="github-とは何か" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="github-とは何か"><span class="header-section-number">1</span> GitHub とは何か</h2>
<section id="一言で言うと" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="一言で言うと"><span class="header-section-number">1.1</span> 一言で言うと……</h3>
<p>まず，GitHub と Git は別物です．一言で言えば，GitHub がコードに特化した Google Drive，Git が Google Document にあたります．</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>GitHub = コードに特化した Google Drive</li>
<li>Git = コードベースで動く，ローカル上の Google Drive</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/DriveLocal.png" class="img-fluid figure-img"></p>
<figcaption>ローカル上の Google Drive のスクリーンショット</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="バージョン管理システム" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="バージョン管理システム"><span class="header-section-number">1.2</span> バージョン管理システム</h3>
<p>Gitとは，<code>.git</code>に「スナップショットのストリーム」を保存する形で動く分散型（全てのユーザーがデータベース＝リポジトリのミラーリングを持つ形）のバージョン管理システムである．ここに独自の形式でsnapshotが保存される．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/Tech/Images/Working.png" class="img-fluid figure-img"></p>
<figcaption>Workflow</figcaption>
</figure>
</div>
</section>
<section id="変更の統合機構" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="変更の統合機構"><span class="header-section-number">1.3</span> 変更の統合機構</h3>
<p>Gitで2つのブランチを統合する方法は3つある．なお，<code>git pull</code>は<code>git fetch</code>と<code>git merge</code>（または<code>git rebase</code>）の合成である．</p>
<section id="fast-forward" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="fast-forward"><span class="header-section-number">1.3.1</span> <code>fast-forward</code></h4>
<p>2つのブランチに違いがあると言っても，「リモートの<code>main</code>ブランチがローカルの<code>main</code>ブランチよりも進んでいる」などの単純な状況である場合は，ただブランチのポインターを「前に進める」だけで良い．</p>
<p>基本，一人で開発しており，別の環境から作業を再開したい場合や，レポジトリが単一のブランチのみで開発が進んでいる場合などはこれで十分．</p>
<p><code>git fast-forward</code>というコマンドがある訳ではなく，ブランチに分岐がない場合に<code>git merge</code>を実行した際に自動的に起こる．</p>
</section>
<section id="rebase" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="rebase"><span class="header-section-number">1.3.2</span> <code>rebase</code></h4>
<p>コミットを「基底状態(base)からの差分」だとすれば，このコミットを，別のブランチに取り込んで足並みを揃える際には<code>rebase</code>が行われる．</p>
<p>他のブランチに適用したいところのコミットが存在するブランチに移動し，適用したいブランチ（例えば<code>target</code>ブランチ）に対して，</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> rebase target</span></code></pre></div>
<p>と実行する．ローカルで<code>rebase</code>の引数を省略した場合は<code>refs/heads/main</code>に適用される．</p>
</section>
<section id="merge" class="level4" data-number="1.3.3">
<h4 data-number="1.3.3" class="anchored" data-anchor-id="merge"><span class="header-section-number">1.3.3</span> <code>merge</code></h4>
<p>2つのブランチの変更を組み合わせて，1つの新しいブランチにまとめる．</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> merge</span></code></pre></div>
<p>により自動で統合を試みるが，失敗した場合は手動で解決する必要あり．</p>
</section>
</section>
<section id="参考" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="参考"><span class="header-section-number">1.4</span> 参考</h3>
<ul>
<li><a href="https://backlog.com/ja/git-tutorial/intro/intro1_1.html">サル先生のGit入門</a></li>
</ul>
</section>
</section>
<section id="仕組み" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="仕組み"><span class="header-section-number">2</span> 仕組み</h2>
<section id="gitディレクトリの中身" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="gitディレクトリの中身"><span class="header-section-number">2.1</span> <code>.git</code>ディレクトリの中身</h3>
<ul>
<li><code>HEAD</code>： 現在チェックアウトしているブランチを指します。これは通常、最新のコミットを指すリファレンスです。</li>
<li><code>config</code>： プロジェクト固有のGit設定を含みます。これには、リモートリポジトリのURL、ブランチの設定などが含まれます。</li>
<li><code>description</code>： GitWebプログラムで使用される説明ファイルですが、一般的なGit操作では使用されません。</li>
<li><code>hooks/</code>： クライアント側またはサーバー側のフックスクリプトを格納するディレクトリです。これらのスクリプトは、特定のイベント（例えばコミットやプッシュ）が発生した際に自動的に実行されます。</li>
<li><code>info/</code>： <code>.gitignore</code>ファイルに追跡しないパターンをグローバルに除外するためのファイルを含みます。</li>
<li><code>objects/</code>： すべてのコンテンツ（コミット、ツリー、ブロブなど）が格納されるディレクトリです。これらはGitによって一意のハッシュ値で識別されます。</li>
<li><code>refs/</code>： コミットオブジェクトを指し示すポインター（ブランチ、タグ、リモートなど）を含むディレクトリです。</li>
<li><code>index</code>： ステージングエリアの情報を格納するファイルです。これは、<code>git add</code> などのコマンドでステージングされた変更を追跡します。</li>
</ul>


</section>
</section>

 ]]></description>
  <category>Tech</category>
  <guid>https://puniupa.github.io/posts/2024/Tech/Git.html</guid>
  <pubDate>Tue, 16 Jul 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>半導体の微細化技術</title>
  <dc:creator>ぷに Draft</dc:creator>
  <link>https://puniupa.github.io/posts/2024/半導体/Semiconductor2.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.heas.jp/lecture/files/uchiyama.pdf"><img src="https://puniupa.github.io/posts/2024/半導体/Images/次世代技術.png" class="img-fluid figure-img" alt="(内山貴之, 2015) より．"></a></p>
<figcaption><span class="citation" data-cites="内山貴之2015">(内山貴之, 2015)</span> より．</figcaption>
</figure>
</div>
<section id="euv-リトグラフィ" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="euv-リトグラフィ"><span class="header-section-number">1</span> EUV リトグラフィ</h2>
<p><a href="https://ja.wikipedia.org/wiki/%E6%A5%B5%E7%AB%AF%E7%B4%AB%E5%A4%96%E7%B7%9A%E3%83%AA%E3%82%BD%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3">極端紫外線リソグラフィ</a> (Extreme Ultraviolet Lithography) は波長 13.5 nm で露光する技術である．</p>
<p>オランダの <a href="https://ja.wikipedia.org/wiki/ASML">ASML</a> 社が唯一 EUV 露光装置を製造している．</p>
<p></p><div id="tweet-31165"></div><script>tweet={"url":"https:\/\/twitter.com\/KS_1013\/status\/1773449946207031474","author_name":"Kazuto Suzuki","author_url":"https:\/\/twitter.com\/KS_1013","html":"\u003Cblockquote class=\"twitter-tweet\" align=\"center\"\u003E\u003Cp lang=\"ja\" dir=\"ltr\"\u003E中国はオランダとの交渉で何とかしてASMLの露光機を売って欲しいと懇願しているが、オランダはレガシー向けのものしか輸出するつもりはないらしい。中国が「米国の言うなりになるな」といってもオランダは「米国の圧力で輸出を止めているわけじゃない」と反論。\u003Ca href=\"https:\/\/t.co\/CsRB29zn9c\"\u003Ehttps:\/\/t.co\/CsRB29zn9c\u003C\/a\u003E\u003C\/p\u003E&mdash; Kazuto Suzuki (@KS_1013) \u003Ca href=\"https:\/\/twitter.com\/KS_1013\/status\/1773449946207031474?ref_src=twsrc%5Etfw\"\u003EMarch 28, 2024\u003C\/a\u003E\u003C\/blockquote\u003E\n\u003Cscript async src=\"https:\/\/platform.twitter.com\/widgets.js\" charset=\"utf-8\"\u003E\u003C\/script\u003E\n\n","width":550,"height":null,"type":"rich","cache_age":"3153600000","provider_name":"Twitter","provider_url":"https:\/\/twitter.com","version":"1.0"};document.getElementById("tweet-31165").innerHTML = tweet["html"];</script><p></p>
<a class="embedly-card" href="https://www.scmp.com/economy/global-economy/article/3257118/china-asks-netherlands-exporter-worlds-top-chipmaking-equipment-avoid-decoupling?utm_source=twitter&amp;utm_campaign=3257118&amp;utm_medium=share_widget">China asks Netherlands, with world-leading chipmaking equipment, to not decouple</a><script async="" src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
<p>ここまで短い波長では光を透過するレンズはなく，反射鏡で光学系を構成する必要がある．13.5 nm という波長はミラーの反射率の極大点の１つをとって決定された． <img src="https://latex.codecogs.com/png.latex?0.68%5E%7B12%7D=0.98"> というように重ねて用いる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/半導体/Images/反射率.png" class="img-fluid figure-img"></p>
<figcaption><span class="citation" data-cites="内山貴之2015">(内山貴之, 2015)</span>　より．</figcaption>
</figure>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-内山貴之2015" class="csl-entry">
内山貴之. (2015). <em>半導体向けEUVリソグラフィの現状と展望</em>. 東芝. Retrieved from <a href="https://www.heas.jp/lecture/files/uchiyama.pdf">https://www.heas.jp/lecture/files/uchiyama.pdf</a>
</div>
</div></section></div> ]]></description>
  <category>半導体</category>
  <guid>https://puniupa.github.io/posts/2024/半導体/Semiconductor2.html</guid>
  <pubDate>Sat, 23 Mar 2024 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/半導体/Images/反射率.png" medium="image" type="image/png" height="107" width="144"/>
</item>
<item>
  <title>これからはじめるベイズ機械学習</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/AI/BAI.html</link>
  <description><![CDATA[ 




<p>現在，産業界における “AI” というと専ら，いくつかの限られた巨大 IT 企業が，巨大ニューラルネットワークを最尤推定で学習させ，これを基盤モデルとして公開し，我々一般庶民はそれを有効活用して下流タスクを安価に解くことだけ考えるという営みを指す．</p>
<p>その産業や生活への破壊的な影響を憂慮しながらも，雨乞いをする日々である．</p>
<div id="fig-Altman" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Altman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="Images/SamAltman.mp4"></video></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Altman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1: 3月19日時点，GPT-5 にも Sora にもアクセス権を持たない我々 v.s. <a href="https://youtu.be/jvqFAi7vkBc?si=hwF_LJAs7XE3bNTR&amp;t=2695">Lex Fridman Podcast</a> に出演した Sam Altman
</figcaption>
</figure>
</div>
<p>AI はそんなものではない．AI はこれにかぎるものではない．</p>
<p>AI が真に我々の友となり，我々の日常をほんとうに豊かにするは，AI の進歩だけが必要なのではなく，<strong>人間との協業が得意になる必要がある</strong>．</p>
<p>そのための第一歩はすでに明らかである．<strong>不確実性の定量化</strong> である．</p>
<p>つまり，「その AI には何が出来て何が出来ないか」「AI の出力がいつ信頼にたるもので，いつ人間の介入が必要であるのか」がわかりやすい形で伝わるコミュニケーション様式をそなえている必要があるのである．<sup>1</sup></p>
<hr>
<p>筆者の知る限り，ここにある全てのナラティブは現時点では全く広く語られているものではなく，筆者も最初の１年の研究生活を通じて朧げながら見えて来たばかりのものである．</p>
<p><strong>不確実性の定量化は，機械学習モデルを民主化し，我々の民芸に取り込むための重要な一歩である</strong>（のではないだろうか？）．</p>
<p>本稿はこの発見を共有するために書いた．筆者の反芻不足から，冗長な部分も多いだろうが，少しでも，琴線に触れるものがあれば幸いである．<sup>2</sup></p>
<div class="hidden">
<p>A Blog Entry on Bayesian Computation by an Applied Mathematician</p>
<p>$$</p>
<p>$$</p>
</div>
<section id="ベイズ機械学習のすすめ" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="ベイズ機械学習のすすめ"><span class="header-section-number">1</span> ベイズ機械学習のすすめ</h2>
<p>我々が AI をより信頼するためには，何が必要だろうか？</p>
<p>筆者の考えでは，信頼への第一歩は <strong>不確実性の定量化</strong> が出来るようになることのはずである．</p>
<p>そしてそのためには <strong>ベイズ機械学習</strong> (Bayesian Machine Learning) の発展による本質的解決が必要不可欠である．本稿はこの点を説明するために執筆されたものである．</p>
<p>筆者に言わせれば，ベイズ機械学習が，今後数年間で AI が経験すべき進展の方向である．この山を越えれば，今まででさえ思っても見なかった未来がひらけてくるだろう．</p>
<blockquote class="blockquote">
<p>Although considerable challenges remain, the coming decade promises substantial advances in artificial intelligence and machine learning based on the probabilistic framework. <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 452)</span></p>
</blockquote>
<section id="ベイズとは何か" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="ベイズとは何か"><span class="header-section-number">1.1</span> ベイズとは何か？</h3>
<p>機械学習において，確率論的なモデリングに基づいたアプローチを <strong>ベイズ機械学習</strong> ともいう．典型的には，モデルの全変数上の結合分布をモデリングし，ベイズ規則によりパラメータのベイズ推定を行う，という手続きからなる．そのため，<strong>確率論的アプローチ</strong> や <strong>モデルベースアプローチ</strong> も同義語として用いられる．<sup>3</sup></p>
<p>一方で，<strong>頻度論的</strong> という言葉は，よく非ベイズ的アプローチを示す接頭辞として用いられる．典型的には，損失関数を設定し，これを最小化するパラメータを探索することによって実行される．</p>
<p>この２つのアプローチは互いに対照的であり，統計学の始まりから基本的な二項対立の図式をなしてきた．</p>
<div class="table-responsive-sm">
<table class="table-striped table-hover caption-top table">
<caption>Contrast of the two main approachs to Machine Learning</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Bayesian</th>
<th style="text-align: center;">Frequentist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Inference is<sup>4</sup></td>
<td style="text-align: center;">Marginalization</td>
<td style="text-align: center;">Approximation</td>
</tr>
<tr class="even">
<td style="text-align: center;">Computational Idea<sup>5</sup></td>
<td style="text-align: center;">Integration</td>
<td style="text-align: center;">Optimization</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Objective</td>
<td style="text-align: center;">Uncertainty Quantification</td>
<td style="text-align: center;">Recovery of True Value</td>
</tr>
<tr class="even">
<td style="text-align: center;">Emphasis</td>
<td style="text-align: center;">Modelling</td>
<td style="text-align: center;">Inference</td>
</tr>
</tbody>
</table>
</div>
<p>しかし，機械学習の時代においては，互いの弱みを補間し合う形で発展していくと筆者は考える．特に，現状の<u><strong>推論偏重でモデリング軽視の風潮が，重要な実世界応用の多くを阻んでしまっている</strong></u>．機械学習の世界樹は実は２本あるのである．</p>
</section>
<section id="ベイズと頻度論との違い" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="ベイズと頻度論との違い"><span class="header-section-number">1.2</span> ベイズと頻度論との違い</h3>
<p>ベイズと頻度論では，確率の解釈も異なるかも知れないが，数学的枠組みとしてはベイズの方が一般的な枠組みであり，また手続き上は，モデリングを重視するか，推論を重視するかの違いでしかない．</p>
<p>実際，殆どの場合，頻度論的手法はある特定の事前分布を持ったベイズ手法とみなせ，逆も然りである．</p>
<p>データから推論を行うには，何らかの仮定が必ず必要であり，それを明示的にモデルに組み込むのがベイズで，推論アルゴリズムにより自動化する精神を持つのが頻度論的手法である．</p>
<p>その結果，優秀な推論アルゴリズムが日夜驚異的なスピードで提案され，今や機械学習手法は教師あり学習・教師なし学習・強化学習の全てで目覚ましい発展を見た．</p>
<p>しかし，ベイズと頻度論の２つの柱のバランスを欠いた発展はここまでである．今や，頻度論的な手法を採用した際に，自分たちがどのような仮定を置いたのか全く明瞭な知識を欠いてしまっている．一方で，現実のビッグで複雑なデータを扱うためには，もはや確率的なモデリングを避けては通れない．<sup>6</sup></p>
<p>極めて本質的で強大な敵に対面しつつあるのである．</p>
<p>だが，現状の病理は明らかであり，頻度論とベイズの手法の間に対応をつけ，足並みを揃えることで次の前進が約束されてる．この意味で，２つの世界樹が必要なのである．</p>
<p>さらに，ベイズ推論は帰納的推論の確率論的拡張と見れるため，エージェントの合理的な学習と意思決定の最良のモデル（の一つ）と信じられている．<sup>7</sup></p>
<p>したがって，<u><strong>ベイズ流解釈により手法を理解し，最適化流解釈により手法を実装する</strong></u>．これがあるべき機械学習の未来であると筆者は考える．</p>
</section>
<section id="つの世界樹" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="つの世界樹"><span class="header-section-number">1.3</span> ２つの世界樹</h3>
<p>今こそ，この２つの手法は根底では繋がっていることをよく周知し，この２つの視座を往来しながら適材適所に使うことが大事だと筆者は考える．</p>
<p>しかしそのためには，ベイズ機械学習の発展が遅れている現状を鑑みて，ベイズの手法のより一層の発展と理解の深化が必要である．<sup>8</sup></p>
<p>本章「ベイズ機械学習のすすめ」は，ベイズの手法の特に肝心と思われる３つの側面を指摘して終わる．以下３章を通じて，</p>
<ol type="1">
<li><p>第 2 節 <u><strong>ベイズは不確実性を定量化する</strong></u></p>
<p>Bayes の方が不確実性の定量化が得意であるため，そのような応用先では頻度論的な手法よりも，Bayes バージョンの手法を用いることが出来ると便利である．</p></li>
<li><p>第 3 節 <u><strong>ベイズは分布という共通言語を与える</strong></u></p>
<p>Bayes による統一的な扱いが理論的に有用である場面が増えている．その際に，Bayes による理論解析と最適化による実際の推論という適材適所の協業が未来の方向であるかも知れない．</p></li>
<li><p>第 4 節 <u><strong>ベイズは理解を促進する</strong></u></p>
<p>ベイズの手法が敬遠されていた理由も，換言すれば，「事前分布」という得体の知れないものを通じて，理論的深淵と直結するためである．ベイズ手法の研究が理論的な解明を要請する．だからこそ，数学者の魂を持った者がこの途を通ることは人類に大きく資すると筆者は考える．</p></li>
</ol>
</section>
</section>
<section id="sec-uncertainty-quantification" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-uncertainty-quantification"><span class="header-section-number">2</span> ベイズは不確実性を定量化する</h2>
<section id="sec-need-for-uncertainty-quantification" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-need-for-uncertainty-quantification"><span class="header-section-number">2.1</span> 不確実性の定量化の必要性</h3>
<p>機械学習と統計学が単なる道具ではなく，人間のより大きなシステムの一環を単独で担う場面が増えてきた．例えば，</p>
<ul>
<li>金融・経営・政策決定などの分野で，意思決定に繋げるデータ解析をするとき</li>
<li>科学において，発見や仮説を検証するためのデータ解析をするとき</li>
<li>ロボットや自動車などの自動化をし，社会に実装するとき<sup>9</sup></li>
<li>医療診断や裁判などの場面で，専門家を補助するシステムを作るとき</li>
</ul>
<p>これらのいずれの例でも，<u><strong>システムの一部を担うにあたって，不確実性を定量化しておくことが欠かせない</strong></u>．その出力を用いるのが人間である場合も勿論，別の機械学習モデルである場合は尚更である．</p>
<p>つまり，人間社会で優秀であるだけでなくホウレンソウと信頼獲得も重要であるように，機械学習モデルも性能の高さと正確さだけでなく，いつその結果を信頼して良いのかを「どの程度」という指標と共に知らせてくれることが信頼関係の基本となるだろう．</p>
<p>実際，殆どの場面で，データから高い確証度で言えることと，そうではないことでは全く違う意味を持つ．それぞれの場面での例には，次のようなものがあるだろう：</p>
<ul>
<li>データから高い確証度で言えることと，意思決定者による采配が必要な部分を分離できない限り，意思決定プロセスの一部として組み込むことが難しく，結局機械学習手法が全く採用されないということもあり得る．</li>
<li>結果の再現可能性が科学の基本的な要請である以上，その結果の不確実性を実験結果に付記することは基本的な科学的態度である．後述（第 2.3.1 節）するが，<img src="https://latex.codecogs.com/png.latex?p">-値や信頼区間などの統計量は<u><strong>これに応えるものではない</strong></u>．</li>
<li>ロボットや自動車の自動化 AI システムは，いくつかのモデルを組み合わせて作ることになるだろう．個々が十分な性能を持っていても，小さな誤差が累積してシステムとしての性能を著しく低下させることがある．これを防ぐために，統一した方法での不確実性の取り扱いが必要である．</li>
<li>個々人の権利と法益が衝突する場面にも AI が利用されより良い生活が実現されるには，法的な解釈可能性が担保される必要があることが，実は大きな難関として我々を待っている．その第一歩は，不確実性の可視化になるだろう．<sup>10</sup></li>
</ul>
<p>以上の内容は，結果の <strong>解釈可能性</strong> でも全く同じことが言えるだろう．</p>
</section>
<section id="信頼のおける-ai-システム" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="信頼のおける-ai-システム"><span class="header-section-number">2.2</span> 信頼のおける AI システム</h3>
<p>上述の点をまとめると，機械学習手法と人間社会がよりよく共生していくには AI の <strong>信頼性</strong> (trustworthyness) が必要とされているのである．不確実性の定量化と解釈可能性は，AI が人間社会で信頼を獲得するにあたって根本的な要素になるだろう．</p>
<p>現状の手法の延長でこの信頼性の問題は扱えず，新たな手法が必要とされている．Bayesian approach や probabilistic approach と呼ばれている試みは，まさにこれに応えるものであり，近年急速に発展している．</p>
</section>
<section id="sec-Bayes-for-uncertainty-quatification" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-Bayes-for-uncertainty-quatification"><span class="header-section-number">2.3</span> 不確実性を扱うには Bayes が必要である</h3>
<p>実装は頻度論的な手法の方が簡単で高速であることが多いが，不確実性の定量化には向かない．</p>
<p>このような場面では，頻度論的手法を頻度論的に改善する，という方向は筋が悪いと思われる．<strong>このようなときこそ，もう一つの世界樹であるベイズの方法を用いるべきである</strong>．</p>
<p>これを，科学における再現性の危機を例にとって確認したい．<sup>11</sup></p>
<section id="sec-replication-crisis" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="sec-replication-crisis"><span class="header-section-number">2.3.1</span> 再現性の危機</h4>
<p>多くの実験科学では不確実性の定量化が必要不可欠である <span class="citation" data-cites="Krzywinski-Altman2013">(Krzywinski and Altman, 2013)</span>．</p>
<blockquote class="blockquote">
<p>It is necessary and true that all of the things we say in science, all of the conclusions, are uncertain … <span class="citation" data-cites="Feynman1998">(Feynman, 1998)</span></p>
</blockquote>
<p><a href="https://ja.wikipedia.org/wiki/%E5%86%8D%E7%8F%BE%E6%80%A7%E3%81%AE%E5%8D%B1%E6%A9%9F"><strong>再現性の危機</strong></a> (replication crisis) とは，多くの実験において報告されている統計的有意性が，再現実験において得られないことが多いという問題を指し，2010年代の初めから多くの科学分野において問題として取り上げられてきた．<sup>12</sup></p>
<p>その理由は明白である．<strong>信頼区間は集合値の推定量であるため，「分散」が十分大きいならば，データセットを変えて何回も計算することでいずれは非自明なものを得ることが出来るのである</strong>．そのため，信頼区間や <img src="https://latex.codecogs.com/png.latex?P">-値を報告するだけでは，結果の信頼性については何も保証されないのである．</p>
<p>その結果多くの科学分野では <strong>Bayes 統計学による不確実性の定量化に移行しつつある</strong> <span class="citation" data-cites="Herzog-Ostwald2013">(Herzog and Ostwald, 2013)</span>, <span class="citation" data-cites="Trafimow-Marks2015">(Trafimow and Marks, 2015)</span>, <span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span>．</p>
<p>信頼区間と信用区間の違いに注目して，その違いを解説する．</p>
</section>
<section id="信頼区間と信用区間" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="信頼区間と信用区間"><span class="header-section-number">2.3.2</span> 信頼区間と信用区間</h4>
<p>「95 % の信頼区間」と言ったとき，「95 % の確率で真の値がその範囲に含まれるような区間」だと思いがちであるが，これはどちらかというと信用区間の説明であり，<strong>信頼区間は計算するごとに値が変わってしまう確率変数である</strong> ことを見落としがちである．<sup>13</sup></p>
<p>つまり，信頼区間は頻度論的な概念であり，「真の値」がまず存在し，区間自体が変動し，95 % の確率で被覆するというのである．今回見ている信頼区間が，別のデータセットで計算した場合にどう変わるかについては全く未知である．</p>
<p>このことは，信頼区間は「真のパラメータの値」で条件づけて得るものであるが，信用区間はデータによって条件づけて得るものであるという点で違う，とまとめられる．この２つの混同は「何で条件づけているか？」を意識することで回避することができる．<sup>14</sup></p>
<p>誤解を恐れず言うならば，再現性の危機とは，信頼区間というサイコロの出目によって科学が踊らされていたということに他ならない <span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span>．<sup>15</sup></p>
</section>
<section id="なぜベイズを用いれば良いのか" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="なぜベイズを用いれば良いのか"><span class="header-section-number">2.3.3</span> なぜベイズを用いれば良いのか？</h4>
<p>これは，信頼区間や <img src="https://latex.codecogs.com/png.latex?P">-値などの頻度論的な手法は，しばしば尤度原理に違反するためである．<sup>16</sup></p>
<p>換言すれば，何らかのモデルと事前分布に関するベイズ手法と等価である，すなわち，Bayesianly justifiable <span class="citation" data-cites="Rubin1984">(Rubin, 1984)</span> とみなせない手法は，何らかの意味でデータを十分に反映できていない可能性が高くなる．</p>
<p>従って，ベイズの手法が原理的に最も適切である場面が多い．一方でその計算の困難さや，全てのステップをモデリング段階に組み込む点を回避するために，種々の頻度論的な実装は考え得て，頻度論的な手法はそのような運用においては健全であるとの指標にもなる．<sup>17</sup></p>
<p>Bayes により手法を理解し，頻度論的に手法を実装することが，あるべき姿勢であると思われる．</p>
<blockquote class="blockquote">
<p>The applied statistician should be Bayesian in principle and calibrated to the real world in practice. <span class="citation" data-cites="Rubin1984">(Rubin, 1984)</span></p>
</blockquote>
</section>
</section>
<section id="ベイズ深層学習という夢" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="ベイズ深層学習という夢"><span class="header-section-number">2.4</span> ベイズ深層学習という夢</h3>
<p>深層モデルはその性能の高さから，最も実世界応用が期待されるモデルであるが，パラメータが極めて多いため，特にベイズ化することが難しいと言われている．</p>
<p>例えば，ハルシネーション (hallucination) として，LLM が「事実に基づかない」情報を生成してしまうことが問題とされているが，これも不確実性の定量化の問題に他ならない．<sup>18</sup></p>
<p>その他の場面でも，不確実性の定量化には conformal prediction などの事後的な手法が試みられている．<sup>19</sup> これらはどのようなブラックボックスに対しても適用可能である一方で，対症療法というべきものであり，ベイズ流の解釈をすることで直接的に事後分布を求めるという根本的な解決にも，もっと注力されるべきである．</p>
<p>ベイズによる不確実性の定量化は，自然であるだけでなく，より有用な不確実性の定量化を与えるものだと予想している．<sup>20</sup></p>
<p>加えて，事前分布を変えることで，種々の帰納バイアスを加えるという「プロンプトエンジニアリング」ならぬ「プライヤーエンジニアリング」の理論が樹立できるかもしれない．すでに，公平性，同変性，スパース性，共変量シフトへの頑健性などを達成するための事前分布が考えられている．<sup>21</sup></p>
</section>
<section id="分野全体の動向" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="分野全体の動向"><span class="header-section-number">2.5</span> 分野全体の動向</h3>
<p>現状の機械学習モデルと実応用との乖離は，他の側面でも生じている．</p>
<p>まず，訓練データが実際の運用環境を十分に反映できていないということは極めて頻繁に起こるだろう．この現象を <strong>分布シフト</strong> といい，機械学種モデルの予測性能だけで無く，分布外汎化 (out-of-distribution generalization) 能力も重視するという潮流が生じている．</p>
<p>さらに，一度訓練したモデルを，分布シフト自体が移り変わっていく環境で，微調整のみによって繰り返し使い続けるという使用を想定した <strong>継続学習</strong> (continual learning) という考え方もある．<sup>22</sup></p>
<p>章を変えて別の角度から議論を続けよう．</p>
</section>
</section>
<section id="sec-distributional-representation" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-distributional-representation"><span class="header-section-number">3</span> ベイズは分布という共通言語を与える</h2>
<section id="継続学習という発想" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="継続学習という発想"><span class="header-section-number">3.1</span> 継続学習という発想</h3>
<p>継続学習は，機械学習モデルをより動的で実際的な環境でも使えるようにするための新たな枠組みである．そこまで，教師あり学習モデルがすでに実用的な性能を獲得したということでもある．</p>
<p>つまり，単に「教師あり」「教師なし」の１タスクを解く営みは爛熟しつつあり，機械学習の理論と応用の最先端は，より深い森に分け入りつつあるのである．</p>
<p>ここにおいて，ベイズ流の接近が統一的な取り扱いを与えるという美点が，さらに重要でもはや必要不可欠な役割を果たすものと思われる．</p>
<section id="ベイズ推論が与える統一的枠組み" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="ベイズ推論が与える統一的枠組み"><span class="header-section-number">3.1.1</span> ベイズ推論が与える統一的枠組み</h4>
<p>ベイズ推論とは，<strong>事前分布</strong> というものを設定して，これをデータによって更新するという営みである（その更新規則は Bayes の公式が与える）．</p>
<p>事前分布をどう設定すれば良いか？の問題は，ベイズ推論の初期からの問題であった．極めて自由度が高いことが，逆にベイズ推論が実際のデータ解析の場面において敬遠される一因ともなっていた．</p>
</section>
<section id="ベイズと最適化との協業" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="ベイズと最適化との協業"><span class="header-section-number">3.1.2</span> ベイズと最適化との協業</h4>
<p>しかし，継続学習が当たり前になった社会において，全てのパラメータ値を事前分布と事後分布とみなし，全ての学習過程をベイズの公式という統一的な方法で更新すると捉えられることは，極めて大きな利点になり得る．</p>
<p>というのも，継続学習においては，学習を繰り返すうちに過去に学んだ内容を忘れ去ってしまうという <strong>壊滅的忘却</strong> (catastrophically forgetting) が最大の困難である．</p>
<p>理論的には，分布のベイズ更新の繰り返しとして見る方が極めて見通しが良い．一方で，事後分布の近似が十分でない場合，実際にベイズ更新を行うことは性能に悪影響を与える．</p>
<p>そこで，理論解析や設計をベイズの観点から行い，実際の推論は最適化ベースで行うという適材適所により，壊滅的忘却を緩和できる可能性がある <span class="citation" data-cites="Farquhar-Gal2019">(Farquhar and Gal, 2019)</span>．</p>
</section>
</section>
<section id="例強化学習への分布によるアプローチ" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="例強化学習への分布によるアプローチ"><span class="header-section-number">3.2</span> 例：強化学習への分布によるアプローチ</h3>
<blockquote class="blockquote">
<p>we believe the value distribution has a central role to play in reinforcement learning. <span class="citation" data-cites="Bellemare+2017">(Bellemare et al., 2017)</span></p>
</blockquote>
</section>
</section>
<section id="sec-inductive-bias" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-inductive-bias"><span class="header-section-number">4</span> ベイズは理解を促進する</h2>
<p>我々はもはや機械学習を通じて，自分たちが何をやっているのかわかっていない．この愚かさを AI に継がせてはならない．</p>
<section id="なぜベイズ法の発展が遅れたか" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="なぜベイズ法の発展が遅れたか"><span class="header-section-number">4.1</span> なぜベイズ法の発展が遅れたか？</h3>
<p>ベイズ法の採用は，自分たちが何をやっているかへの理解と解釈可能性を刺激するという側面がある．</p>
<p>その理由は簡単である．ベイズ推論は，モデルとその上の事前分布を定めれば，あとはベイズ更新規則をどう計算するかの問題となり，近似手法は様々あれど，<strong>もはや推論手法に選択の余地はない</strong>．</p>
<p>換言すれば，その分解析者がモデルと事前分布の特定を全てこなす必要があるのであり，<strong>解析者に確率モデリングへの理解を強要する</strong>ところがある．</p>
<p>しかしこれは「面倒なことは全てアルゴリズムにやってほしい」という精神とは対立するため，ベイズの美点であると同時に，ベイズの発展を阻害してきた遠因の一つでもあった．</p>
<p>これを指して「事前分布の選択に恣意性が入る」という通り文句がよく使われるが，<u>実際は，頻度論的手法における「どのような目的関数をどのように最適化すれば良いか？」という恣意性に変換されているのみであり，問題を先送りにして，「ベイズ法 対 頻度論的手法」という虚構の対立を作り上げているのみである</u>．</p>
<p>機械学習のポテンシャルが具現化したいまこそ，この困難に立ち向かう必要があるが，この問題は最適化や頻度論的な立場から見るより，ベイズの立場から見た方が，理論的な見通しが良いようである（第 4.4 節）．</p>
</section>
<section id="帰納バイアスの明確化の必要性" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="帰納バイアスの明確化の必要性"><span class="header-section-number">4.2</span> 帰納バイアスの明確化の必要性</h3>
<p>機械学習の真の理解のためには，各モデルの帰納バイアスを明確化する必要がある．</p>
<section id="帰納バイアスとは何か" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="帰納バイアスとは何か"><span class="header-section-number">4.2.1</span> 帰納バイアスとは何か？</h4>
<p>現状の AI システムは大量のラベル付きデータが必要であり，多くの現実的に有用なタスクでこのような教師データが用意できるわけではない．</p>
<p>一方で，人間は遥かに少ないデータから効率的に学習することができる．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/AI/Images/model_sizes.png" class="img-fluid figure-img"></p>
<figcaption>Number of Training Tokens <a href="https://babylm.github.io/">BabyLM Challenge</a></figcaption>
</figure>
</div>
<p>その違いは，進化が我々生物に授けた <strong>帰納バイアス</strong> にあると考えられている．</p>
<p>我々には遺伝的に継がれている生まれ持った学習特性があり，より効率的に学習出来るのかも知れない．</p>
<p>事実，一度事前学習をした LLM は，極めて少ないデータにより新しいタスクを学習することができるがわかりつつある <span class="citation" data-cites="Zhou+2023">(Zhou et al., 2023)</span>．<a href="https://162348.github.io/posts/2024/Kernels/Deep2.html#sec-foundation-model">LLM の事後調整に関する稿</a> も参照．</p>
</section>
<section id="事前分布に向き合わずにやり過ごしてきた" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="事前分布に向き合わずにやり過ごしてきた"><span class="header-section-number">4.2.2</span> 事前分布に向き合わずにやり過ごしてきた</h4>
<p>現状，多くの機械学習手法は確率的な方法を取っていない．これは事前分布を明示せずに（ひょっとしたら明後日の方向に向かって）行われる Bayes 学習手法であるとみなせる．</p>
<p>現状の機械学習の成功は，事前分布に関する知識なしに到達されたものであり，それ故の限界がある．例えば，現状のままではモデルにどのような帰納バイアスが組み込まれているか不明瞭である．<sup>23</sup></p>
</section>
<section id="帰納バイアスに対するベイズ的視点" class="level4" data-number="4.2.3">
<h4 data-number="4.2.3" class="anchored" data-anchor-id="帰納バイアスに対するベイズ的視点"><span class="header-section-number">4.2.3</span> 帰納バイアスに対するベイズ的視点</h4>
<p>データの空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D"> 上の任意のモデル <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BM%7D"> の周辺尤度 <img src="https://latex.codecogs.com/png.latex?p(x%7C%5Cmathcal%7BM%7D)"> は，<sup>24</sup> ベイズ流には事後確率として捉えられ，全てのデータ <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathcal%7BX%7D"> 上に有限な測度を定める．<sup>25</sup></p>
<p>よって，<strong>全てのモデルは，あるデータを得意とするならば他のデータについては不得意であることを免れない</strong>．これは no free lunch 定理と呼ばれる定理の一群により推測されており，分類問題などの簡単なタスクを除いて完全な形式的表現はまだ持たない作業仮設である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/AI/Images/mackay.png" class="img-fluid figure-img"></p>
<figcaption>A Probabilistic Perspective of Genelization <span class="citation" data-cites="Wilson-Izmailov2020">(Wilson and Izmailov, 2020)</span></figcaption>
</figure>
</div>
<p>例えば，<a href="https://162348.github.io/posts/2024/Kernels/Deep2.html#sec-fine-tuning">基盤モデル</a> とは，インターネット上のデータから最大限人間の言語というものに関する帰納バイアスを取り込んだ，パラメータ上の初期設定であると見れる．</p>
<p>これは，あるパラメータ空間上の理想的な事前分布からのサンプリングであるかも知れない．それ故，種々の下流タスクに対して，小さなモデル変更のみにより適応することが出来る．</p>
<p>大規模言語モデルの能力創発現象は，帰納バイアスを十分取り込むことにより自然に解かれるタスクであったのかもしれない．</p>
</section>
<section id="worst-case-analysis-からの脱皮" class="level4" data-number="4.2.4">
<h4 data-number="4.2.4" class="anchored" data-anchor-id="worst-case-analysis-からの脱皮"><span class="header-section-number">4.2.4</span> worst-case analysis からの脱皮</h4>
<p>帰納バイアスを明確にせず，やり過ごしてきたつけが，特に学習理論においても現れている．</p>
<p>現状の統計的学習理論は全て，worst-case analysis であるが，実用上は全くそうではない．「動くモデル」には暗黙の帰納バイアスが入っており，これに明るくなる必要があるのである．</p>
<p>2024 年に生きる我々は，worst-case analysis からの脱皮を迫られている．</p>
</section>
</section>
<section id="数学者の哲学" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="数学者の哲学"><span class="header-section-number">4.3</span> 数学者の哲学</h3>
<p>Bayes の見方は，機械学習モデルを底流する数理的枠組みになっている．仮に次の <a href="https://ja.wikipedia.org/wiki/%E3%82%BD%E3%83%BC%E3%83%B3%E3%83%80%E3%83%BC%E3%82%B9%E3%83%BB%E3%83%9E%E3%83%83%E3%82%AF%E3%83%AC%E3%83%BC%E3%83%B3">Mac Lane</a> の言葉が数学者のあるべき態度の１つであるとするならば，この意味での数学者には Bayes の立場から機械学習を研究することを特におすすめする．</p>
<blockquote class="blockquote">
<p>However, I persisted in the position that <strong>as mathematicians we must know whereof we speak</strong>, be it a homotopy group or an adjoint functor. <span class="citation" data-cites="MacLane1983">(Mac&nbsp;Lane, 1983, p. 55)</span></p>
</blockquote>
<p>数理統計学に始まり，数学者の統計や機械学習分野への参入は，推論手法の解析が想像されるかも知れない．</p>
<p>しかし，真の数学的理解は，手法の数学的な機械仕掛けを紐解くだけでなく，それぞれの手法がモデルとしてどのような仮定の下で成り立っているかを，モデリングの観点から理解することにもあると筆者には思われる．</p>
<p>現状，後者の視点が大変に不足しており，数理的な知識に支えられた大局観というものがない．<u><strong>個々の数学的な道具に捉われず，大局的な構造を捉える数理的枠組みが必要である</strong></u>．</p>
<p>これに応えるのがベイズの枠組みであると筆者は信じる．</p>
<p>推論とモデリングという双対的な営みは深い数理的な構造を持っていることが明らかになりつつある．この大局的構造の解明と理論構築には，ベイズの観点から光を照らしてくれるような，<strong>Mac Lane の意味での数学者的な魂</strong>が必要とされているのである．</p>
<section id="bayes-の数学" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="bayes-の数学"><span class="header-section-number">4.3.1</span> Bayes の数学</h4>
<p>Bayes 流の解釈では，どんなにモデルが複雑で巨大になろうとも，推論とは積分に他ならない．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/AI/Images/Bayes.svg" class="img-fluid figure-img"></p>
<figcaption>Bayes’ Theorem (density form)</figcaption>
</figure>
</div>
<p>全ての（尤度原理に則った）推論は，事後分布の関数としてなされる（べきである）．</p>
<p>実際の実装は，その近似として実行される（べきである）．</p>
<p>よって，実装とモデリングの段階を明確に分離する枠組みを提供している上に，極めて普遍的な枠組みである．</p>
<p>というのも，Bayes 流のモデリングは，<a href="https://162348.github.io/posts/2023/Probability/MarkovCategory.html">Markov 圏</a> 上の図式と見ることができ（第 5.2 節），普遍的である上に，数学的にも最も直接的で直感的な表現であると思われる．</p>
<p>圏として持つ代数的性質は，モデルの結合・分解が自由に出来るということに繋がり，<a href="https://ja.wikipedia.org/wiki/%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB">モジュール性</a> が高いということになる．</p>
<blockquote class="blockquote">
<p>I basically know of two principles for treating complicated systems in simple ways: the ﬁrst is the <strong>principle of modularity</strong> and the second is the <strong>principle of abstraction</strong>. I am an apologist for computational probability in machine learning because I believe that <strong>probability theory implements these two principles in deep and intriguing ways</strong> — namely through factorization and through averaging. Exploiting these two mechanisms as fully as possible seems to me to be the way forward in machine learning. Michael I. Jordan excerpted from <span class="citation" data-cites="Frey1998">(Frey, 1998)</span></p>
</blockquote>
<p>分布を明示的に用いた <a href="https://162348.github.io/static/Notations.html#sec-kernels"><strong>確率核</strong></a> を通じてのモデリングは，なぜだか数学的に極めて自然なアプローチを提供してくれるようである．</p>
</section>
<section id="ベイズの代数幾何解析" class="level4" data-number="4.3.2">
<h4 data-number="4.3.2" class="anchored" data-anchor-id="ベイズの代数幾何解析"><span class="header-section-number">4.3.2</span> ベイズの代数・幾何・解析</h4>
<p>上述したように，ベイズのモデリング法と学習規則は本質的に代数的なところがある．</p>
<p>加えて，分布を基本言語とするために，ベイズ推論においては空間 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)%5Csubset%5Cmathcal%7BM%7D%5E1(%5Cmathcal%7BX%7D)"> が極めて基本的な役割を果たす．</p>
<p>サンプリングは <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の幾何学に関係が深く，情報幾何学や最適輸送などの発展が見られている．</p>
<p>一方で最適化は <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の解析学に関係が深く，古くから機械学習分野では <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D(%5Cmathcal%7BX%7D)"> 上の様々な汎函数が <strong>ダイバージェンス</strong> の名前で考察されており，その勾配流として種々の最適化手法が理解できる．</p>
</section>
<section id="bayes-に繋げる数学" class="level4" data-number="4.3.3">
<h4 data-number="4.3.3" class="anchored" data-anchor-id="bayes-に繋げる数学"><span class="header-section-number">4.3.3</span> Bayes に繋げる数学</h4>
<p>通常の頻度論的手法は，うまくいくことが先であり，理論が後付けされる．そしてその理論もどこか ad-hoc というべきであり，worst-case で漸近論的である．</p>
<p>これらに Bayes 的な解釈を与えることで，暗黙のうちにどのような仮定を課しているモデリング手法に相等するのか明確にされる．特に，非漸近論的な知見を与えてくれる数少ないの道の一つである．</p>
</section>
</section>
<section id="sec-Bayesian-rule" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="sec-Bayesian-rule"><span class="header-section-number">4.4</span> ベイズ推論とみる美点</h3>
<p>ベイズ推論自体への理解だけでなく，種々の頻度論的手法を（特定の環境下での）ベイズ推論の近似として理解することは，新たなアルゴリズムの開発に有用であるという合意が形成されつつあるようである．<sup>26</sup></p>
<p>最適化に基づく手法の計算効率性は，正確なベイズ推論に勝る場面も多い．ここで注意すべきは，ベイズ推論の実行が肝要であり，その実装は最適化に依ろうと，積分近似に依ろうと大した違いではないのである．</p>
<p>「ベイズ推論は多くの最尤法に基づく手法よりも，自然な正則化がなされるために過学習の問題がない．」と説明されるが<u><strong>本来は逆である</strong></u>．多くの最適化に基づく手法は，目的関数の選択に恣意性があり，その選択を誤り続けているために過学習という問題が生じている，という方が，後世の教科書に載る表現なのではないかと筆者は考えている．</p>
<p>そこで，種々の既存手法のベイズ流の解釈を探究することは，より良い推論アルゴリズムの開発に資すると考えられている．</p>
<p>この方向の近年の発展をいくつか紹介したい．</p>
<section id="ベイズ学習規則" class="level4" data-number="4.4.1">
<h4 data-number="4.4.1" class="anchored" data-anchor-id="ベイズ学習規則"><span class="header-section-number">4.4.1</span> ベイズ学習規則</h4>
<p>現状の機械学習は，統計学，連続最適化，計算機科学の知識を総動員して開発された種々の推論手法によって支えられている．</p>
<p>その性能は驚異的なスピードで向上しているが，それぞれの手法がどのような仮定をモデリングの段階で課しているかが不明瞭であり，どの手法を使うべきかの統一的な枠組みは得られていない．</p>
<p>この現状の抜本的な改善が，それぞれの手法のベイズ流の解釈を探究することで得られると考えられる．</p>
<p>その枠組みの一つが <strong>ベイズ学習規則</strong> <span class="citation" data-cites="Khan-Rue2023">(Khan and Rue, 2023)</span> である．</p>
<p><span class="citation" data-cites="Khan-Rue2023">(Khan and Rue, 2023, p. 4)</span> では，ベイズ流の解釈を持つ種々の手法が他より優れている理由として，目的関数に現れるエントロピー項が <strong>自然勾配</strong> の概念を通じて自然な正則化を与えることが，ベイズ学習規則という新たな理論的枠組みの中で示されている．</p>
</section>
<section id="例強化学習" class="level4" data-number="4.4.2">
<h4 data-number="4.4.2" class="anchored" data-anchor-id="例強化学習"><span class="header-section-number">4.4.2</span> 例：強化学習</h4>
<p>強化学習でも，モデルベースのアプローチが取り入れられつつあり <span class="citation" data-cites="Deisenroth-Rasmussen2011">(Deisenroth and Rasmussen, 2011)</span>，さらに学習と制御をベイズ推論と見ることが，アルゴリズムの設計において有用であることが提唱されつつある：</p>
<blockquote class="blockquote">
<p>Crucially, in the framework of PGMs, it is sufficient to write down the model and pose the question, and the objectives for learning and inference emerge automatically. <span class="citation" data-cites="Levine2018">(Levine, 2018)</span></p>
</blockquote>
</section>
</section>
</section>
<section id="bayes-機械学習の例" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="bayes-機械学習の例"><span class="header-section-number">5</span> Bayes 機械学習の例</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" title="要約">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
要約
</div>
</div>
<div class="callout-body-container callout-body">
<p>深層学習モデルにより教師あり学習は十分に発展し，多くの訓練データが得られる場面では驚異的な性能を発揮するようになった．</p>
<p>この発展は，モデリングの仮定に捉われずに純粋にアルゴリズムの開発に集中することが出来るという頻度論的な枠組みの利点を有効活用する形で達成された．</p>
<p>しかし，殆どの実世界応用では，不確実性のモデリングが必要不可欠である．この点を後回しにして性能を追求することで得た栄華である．だからこそ，極めて高い性能を誇るモデルを，実世界応用の場面で有効活用する手段を我々はまだ知らないのである．</p>
<p>その鍵はベイズにある．安全性，信頼性，柔軟性……．これらの21世紀の社会の要請に応えるためには，ベイズ機械学習手法の発展と，既存の手法のベイズ流の理解とが追いつくことが，第一歩である．</p>
</div>
</div>
<p>既存の深層学習モデルは，「教師あり学習」という枠組みや，画像の分類タスクや自然言語処理のタスクなど，広く周知された問題設定とデータセットが存在する．</p>
<p>一方で，ベイズ機械学習における対応物はまだ十分に周知されていないようである．</p>
<p>ベイズ機械学習では「損失を最小化する」という枠組みの中でなるべく性能の良い推論手法を探す，というわかりやすい枠組みがある訳ではないようである．</p>
<p>そこで，本章ではベイズ機械学習の近年の発展を概観することを試みる．</p>
<section id="bayes-深層学習" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="bayes-深層学習"><span class="header-section-number">5.1</span> Bayes 深層学習</h3>
<p>ニューラルネットワークモデルは，隠れ素子数が無限大になる極限において，Gauss 過程モデルに漸近することが知られている <span class="citation" data-cites="Neal1996">(Neal, 1996)</span>．Gauss 過程とはノンパラメトリックなベイズ機械学習手法の代表である．この対応を通じて，深層学習のベイズ流の解釈が進められている．</p>
<p>この稿の執筆後，本稿をまとめるかのようなアブストラクトを持ったポジションペーパー <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> が公開された</p>
<blockquote class="blockquote">
<p>In the current landscape of deep learning research, there is a predominant emphasis on achieving high predictive accuracy in supervised tasks involving large image and language datasets. However, a broader perspective reveals a multitude of overlooked metrics, tasks, and data types, such as uncertainty, active and continual learning, and scientific data, that demand attention. Bayesian deep learning (BDL) constitutes a promising avenue, offering advantages across these diverse settings. <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span></p>
</blockquote>
<p>深層学習をベイズ化することで，上にあげた</p>
<ul>
<li>不確実性の自然な定量化</li>
<li>継続学習への柔軟な接続</li>
<li>科学的営みの促進</li>
</ul>
<p>などが目指せる．特に，現状の大規模な基盤モデルをベイズ化する悲願を真っ向から論じている．</p>
</section>
<section id="sec-graphical-model" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="sec-graphical-model"><span class="header-section-number">5.2</span> 確率的グラフィカルモデル</h3>
<p>歴史的に，（確率的）モデリングは，主に（確率的）グラフィカルモデルを通じて機械学習の分野に導入された．</p>
<p>そのため，20世紀に入ったばかりの頃は，Bayes 機械学習の唯一の例は確率的グラフィカルモデルなのであった．<sup>27</sup></p>
<p>だが，確率的グラフィカルモデルは，極めて普遍的で，従来の因果推論・階層モデル・欠測モデル・潜在変数モデル・構造方程式モデルなどの発展を包含する統一的な枠組みであることをより広く認識すべきである．</p>
<section id="ベイジアンネットワーク" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="ベイジアンネットワーク"><span class="header-section-number">5.2.1</span> ベイジアンネットワーク</h4>
<p>Bayesian Network は Markov 圏上の図式であり，方向関係のある変数間の関係をモデリングする最も直接的な方法である．</p>
</section>
<section id="構造的因果モデル" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="構造的因果モデル"><span class="header-section-number">5.2.2</span> 構造的因果モデル</h4>
</section>
<section id="階層モデル" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="階層モデル"><span class="header-section-number">5.2.3</span> 階層モデル</h4>
<p>階層モデルとは，ベイズの枠組みでは，観測変数・潜在変数の区別なく，モデルを自由に結合出来る点を利用したモデリング手法である．</p>
</section>
<section id="モデルの属人化" class="level4" data-number="5.2.4">
<h4 data-number="5.2.4" class="anchored" data-anchor-id="モデルの属人化"><span class="header-section-number">5.2.4</span> モデルの属人化</h4>
<p>大きなデータも，属人化医療や推薦システムなど多くの文脈では小さなデータの寄せ集めであり，そうでなくともその構造を正しく捉え，全ての不確実性を取り入れた柔軟なモデリングをすることで，さらに密接な形で社会に取り入れることができる．<sup>28</sup></p>
</section>
</section>
<section id="確率的プログラミング" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="確率的プログラミング"><span class="header-section-number">5.3</span> 確率的プログラミング</h3>
<section id="アルゴリズムのプログラミングからモデルのプログラミングへ" class="level4" data-number="5.3.1">
<h4 data-number="5.3.1" class="anchored" data-anchor-id="アルゴリズムのプログラミングからモデルのプログラミングへ"><span class="header-section-number">5.3.1</span> アルゴリズムのプログラミングから，モデルのプログラミングへ</h4>
<p>ベイズ流の解釈では，解析者の恣意的な選択はモデリングの段階に集中しており，モデルが決定すれば推論手法は自動的に従う．</p>
<p>このパラダイムでは，推論手法は背後に隠し，解析者はモデリングに集中するための新たなプログラミング言語があっても良いはずである．</p>
<p>このような言語を <strong>確率的プログラミング</strong> (Probabilistic Programming) 言語と呼ぶ．</p>
</section>
<section id="確率的プログラミングはグラフィカルモデルの拡張である" class="level4" data-number="5.3.2">
<h4 data-number="5.3.2" class="anchored" data-anchor-id="確率的プログラミングはグラフィカルモデルの拡張である"><span class="header-section-number">5.3.2</span> 確率的プログラミングはグラフィカルモデルの拡張である</h4>
<p>確率的グラフィカルモデルをどのようにプログラムに落とし込むかというと，確率核をシミュレーターとして実装するのである．</p>
<p>逆に，シミュレーションが可能な限りどのようなモデルも実装できるので，確率的グラフィカルモデルの真の拡張であると言える．<sup>29</sup></p>
</section>
<section id="simulation-based-inference" class="level4" data-number="5.3.3">
<h4 data-number="5.3.3" class="anchored" data-anchor-id="simulation-based-inference"><span class="header-section-number">5.3.3</span> Simulation-based Inference</h4>
<p>上述の通り，シミュレーターがあればモデルが定義でき，モデルがあれば推論ができる．さらに，棄却法，重点サンプリング法，MCMC，SMC などの Monte Carlo 法のレパートリーにより，殆どあらゆるシミュレーションと推論が統一的に実行できる．これが Bayes 推論の強みである．</p>
</section>
</section>
<section id="bayes-最適化" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="bayes-最適化"><span class="header-section-number">5.4</span> Bayes 最適化</h3>
<p>ベイズはシステムの一部として自然に組み込まれると論じたが（第 2.1 節），現状その最先端をいくのがベイズ最適化の分野である．</p>
<p>ベイズ最適化は最も簡単な形では，未知の関数 <img src="https://latex.codecogs.com/png.latex?f:X%5Cto%5Cmathbb%7BR%7D"> の最大値点を求める問題を，<a href="https://en.wikipedia.org/wiki/Sequential_analysis">逐次意思決定問題</a> として解く手法である．</p>
<p>ベイズ数値計算 <span class="citation" data-cites="Hagen1991">(O’Hagan, 1991)</span> の現代的な再解釈とも捉えられる．<sup>30</sup></p>
<p>この際，未知の関数 <img src="https://latex.codecogs.com/png.latex?f"> を Gauss 過程などでモデリングし，不確実性の高い点からサンプル <img src="https://latex.codecogs.com/png.latex?f(x_1),f(x_2),%5Ccdots"> を取って最も効率の良い方法で最大化していくことを目指す．</p>
<p>ベイズ最適化は多腕バンディット問題と関係が深く，２つの問題は共に一方向のエージェント・環境相互作用しか仮定していないという形での強化学習への入り口である．</p>
</section>
<section id="確率的データ圧縮" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="確率的データ圧縮"><span class="header-section-number">5.5</span> 確率的データ圧縮</h3>
<p>殆どの（可逆）データ圧縮アルゴリズムは，シンボルの列に対する確率的モデリングと等価である．<sup>31</sup> そしてモデルの予測精度が良いほど，データの圧縮率は高い．</p>
<p>したがって，より良いベイズ（ノンパラメトリック）モデルの開発と，より幅広いデータに対するデータ圧縮技術の発展とは両輪である．<sup>32</sup></p>
</section>
<section id="モデルの自動発見" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="モデルの自動発見"><span class="header-section-number">5.6</span> モデルの自動発見</h3>
<p>機械学習の精神の一つに，データからの知識獲得をなるべく自動化したいというものがある．</p>
<p>ベイズの方から，統計解析自体を自動化する Automatic Statistician <span class="citation" data-cites="Lloyd+2014">(Lloyd et al., 2014)</span> という試みがある．これはデータを説明するモデルを自動発見し，結果を自然言語でまとめてくれる上に，モデルに含まれる不確実性に関しても報告してくれる．</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Amershi+2019" class="csl-entry">
Amershi, S., Weld, D., Vorvoreanu, M., Fourney, A., Nushi, B., Collisson, P., … Horvitz, E. (2019). <a href="https://doi.org/10.1145/3290605.3300233">Guidelines for human-AI interaction</a>. In <em>Proceedings of the 2019 CHI conference on human factors in computing systems</em>, pages 1–13. New York, NY, USA: Association for Computing Machinery.
</div>
<div id="ref-Angrist-Pischke2010" class="csl-entry">
Angrist, J. D., and Pischke, J.-S. (2010). <a href="http://www.jstor.org/stable/25703496">The credibility revolution in empirical economics: How better research design is taking the con out of econometrics</a>. <em>The Journal of Economic Perspectives</em>, <em>24</em>(2), 3–30.
</div>
<div id="ref-Bensal+2019" class="csl-entry">
Bansal, G., Nushi, B., Kamar, E., Weld, D. S., Lasecki, W. S., and Horvitz, E. (2019). <a href="https://doi.org/10.1609/aaai.v33i01.33012429">Updates in human-AI teams: Understanding and addressing the performance/compatibility tradeoff</a>. <em>Proceedings of the AAAI Conference on Artificial Intelligence</em>, <em>33</em>(01), 2429–2437.
</div>
<div id="ref-Bellemare+2017" class="csl-entry">
Bellemare, M. G., Dabney, W., and Munos, R. (2017). <a href="https://proceedings.mlr.press/v70/bellemare17a.html">A distributional perspective on reinforcement learning</a>. In D. Precup and Y. W. Teh, editors, <em>Proceedings of the 34th international conference on machine learning</em>,Vol. 70, pages 449–458. PMLR.
</div>
<div id="ref-Broderick+2023" class="csl-entry">
Broderick, T., Gelman, A., Meager, R., Smith, A. L., and Zheng, T. (2023). <a href="https://doi.org/10.1126/sciadv.abn3999">Toward a taxonomy of trust for probabilistic machine learning</a>. <em>Science Advances</em>, <em>9</em>(7), eabn3999.
</div>
<div id="ref-Chen+2023" class="csl-entry">
Chen, J., Monica, J., Chao, W.-L., and Campbell, M. (2023). <a href="https://arxiv.org/abs/2305.20044">Probabilistic uncertainty quantification of prediction models with application to visual localization</a>.
</div>
<div id="ref-Deisenroth-Rasmussen2011" class="csl-entry">
Deisenroth, M. P., and Rasmussen, C. E. (2011). PILCO: A model-based and data-efficient approach to policy search. In <em>Proceedings of the 28th international conference on international conference on machine learning</em>, pages 465–472. Madison, WI, USA: Omnipress.
</div>
<div id="ref-Efron1986" class="csl-entry">
Efron, B. (1986). <a href="http://www.jstor.org/stable/2683105">Why isn’t everyone a bayesian?</a> <em>The American Statistician</em>, <em>40</em>(1), 1–5.
</div>
<div id="ref-Farquhar-Gal2019" class="csl-entry">
Farquhar, S., and Gal, Y. (2019). <a href="https://arxiv.org/abs/1902.06494">A unifying bayesian view of continual learning</a>.
</div>
<div id="ref-Feynman1998" class="csl-entry">
Feynman, R. P. (1998). <em><a href="">The meaning of it all: Thoughts of a citizen scientist</a></em>. Addison-Wesley.
</div>
<div id="ref-Frey1998" class="csl-entry">
Frey, B. J. (1998). <em><a href="https://mitpress.mit.edu/9780262062022/graphical-models-for-machine-learning-and-digital-communication/">Graphical models for machine learning and digital communication</a></em>. The MIT Press.
</div>
<div id="ref-Gal-Ghahramani2016" class="csl-entry">
Gal, Y., and Ghahramani, Z. (2016). <a href="https://openreview.net/forum?id=3QxqXoJEyfp7y9wltP11">Bayesian convolutional neural networks with bernoulli approximate variational inference</a>. In <em>International conference on learning representations</em>.
</div>
<div id="ref-Ghahramani2015" class="csl-entry">
Ghahramani, Z. (2015). <a href="https://www.nature.com/articles/nature14541">Probabilistic machine learning and artificial intelligence</a>. <em>Nature</em>, <em>521</em>, 452–459.
</div>
<div id="ref-Herzog-Ostwald2013" class="csl-entry">
Herzog, S., and Ostwald, D. (2013). <a href="https://doi.org/10.1038/494035b">Sometimes bayesian statistics are better</a>. <em>Nature</em>, <em>494</em>(7435), 35–35.
</div>
<div id="ref-Khan-Rue2023" class="csl-entry">
Khan, M. E., and Rue, H. (2023). <a href="http://jmlr.org/papers/v24/22-0291.html">The bayesian learning rule</a>. <em>Journal of Machine Learning Research</em>, <em>24</em>(281), 1–46.
</div>
<div id="ref-Krzywinski-Altman2013" class="csl-entry">
Krzywinski, M., and Altman, N. (2013). <a href="https://doi.org/10.1038/nmeth.2613">Importance of being uncertain</a>. <em>Nature Methods</em>, <em>10</em>(9), 809–810.
</div>
<div id="ref-Levine2018" class="csl-entry">
Levine, S. (2018). <a href="https://arxiv.org/abs/1805.00909">Reinforcement learning and control as probabilistic inference: Tutorial and review</a>.
</div>
<div id="ref-Lloyd+2014" class="csl-entry">
Lloyd, J. R., Duvenaud, D., Grosse, R., Tenenbaum, J. B., and Ghahramani, Z. (2014). Automatic construction and natural-language description of nonparametric regression models. In <em>Proceedings of the twenty-eighth AAAI conference on artificial intelligence</em>, pages 1242–1250. Québec City, Québec, Canada: AAAI Press.
</div>
<div id="ref-MacLane1983" class="csl-entry">
Mac&nbsp;Lane, S. (1983). <a href="https://doi.org/10.1007/BF03026510">The health of mathematics</a>. <em>The Mathematical Intelligencer</em>, <em>5</em>(4), 53–56.
</div>
<div id="ref-Mohri-Hashimoto2024" class="csl-entry">
Mohri, C., and Hashimoto, T. (2024). <a href="https://arxiv.org/abs/2402.10978">Language models with conformal factuality guarantees</a>.
</div>
<div id="ref-Murphy2022" class="csl-entry">
Murphy, K. P. (2022). <em><a href="https://probml.github.io/pml-book/book1.html">Probabilistic machine learning: An introduction</a></em>. MIT Press.
</div>
<div id="ref-Neal1996" class="csl-entry">
Neal, R. M. (1996). <em><a href="https://link.springer.com/book/10.1007/978-1-4612-0745-0">Bayesian learning for neural networks</a></em>,Vol. 118. Springer New York.
</div>
<div id="ref-Neal-Hinton1998" class="csl-entry">
Neal, R. M., and Hinton, G. E. (1998). <a href="https://link.springer.com/chapter/10.1007/978-94-011-5014-9_12">Learning in graphical models</a>. In M. I. Jordan, editor, pages 355–368. Springer Dordrecht.
</div>
<div id="ref-Novello+2024" class="csl-entry">
Novello, P., Dalmau, J., and Andeol, L. (2024). <a href="https://arxiv.org/abs/2403.11532">Out-of-distribution detection should use conformal prediction (and vice-versa?)</a>.
</div>
<div id="ref-Nuzzo2014" class="csl-entry">
Nuzzo, R. (2014). <a href="https://doi.org/10.1038/506150a">Scientific method: Statistical errors</a>. <em>Nature</em>, <em>506</em>(7487), 150–152.
</div>
<div id="ref-Hagen1991" class="csl-entry">
O’Hagan, A. (1991). <a href="https://doi.org/10.1016/0378-3758(91)90002-V">Bayes–hermite quadrature</a>. <em>Journal of Statistical Planning and Inference</em>, <em>29</em>(3), 245–260.
</div>
<div id="ref-Papamarkou+2024" class="csl-entry">
Papamarkou, T., Skoularidou, M., Palla, K., Aitchison, L., Arbel, J., Dunson, D., … Zhang, R. (2024). <a href="https://arxiv.org/abs/2402.00809">Position paper: Bayesian deep learning in the age of large-scale AI</a>.
</div>
<div id="ref-Rubin1984" class="csl-entry">
Rubin, D. B. (1984). <a href="https://doi.org/10.1214/aos/1176346785"><span class="nocase">Bayesianly Justifiable and Relevant Frequency Calculations for the Applied Statistician</span></a>. <em>The Annals of Statistics</em>, <em>12</em>(4), 1151–1172.
</div>
<div id="ref-Steinruecken+2015" class="csl-entry">
Steinruecken, C., Ghahramani, Z., and MacKay, D. (2015). <a href="https://doi.org/10.1109/DCC.2015.77">Improving PPM with dynamic parameter updates</a>. In <em>2015 data compression conference</em>, pages 193–202.
</div>
<div id="ref-Trafimow-Marks2015" class="csl-entry">
Trafimow, D., and Marks, M. (2015). <a href="https://doi.org/10.1080/01973533.2015.1012991">Editorial</a>. <em>Basic and Applied Social Psychology</em>, <em>37</em>(1), 1–2.
</div>
<div id="ref-Wamg+2024" class="csl-entry">
Wang, L., Zhang, X., Su, H., and Zhu, J. (2024). <a href="https://doi.org/10.1109/TPAMI.2024.3367329">A comprehensive survey of continual learning: Theory, method and application</a>. <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 1–20.
</div>
<div id="ref-Wilson-Izmailov2020" class="csl-entry">
Wilson, A. G., and Izmailov, P. (2020). <a href="https://proceedings.neurips.cc/paper/2020/hash/322f62469c5e3c7dc3e58f5a4d1ea399-Abstract.html">Bayesian deep learning and a probabilistic perspective of generalization</a>. In <em>Proceedings of the 34th international conference on neural information processing systems</em>. Red Hook, NY, USA: Curran Associates Inc.
</div>
<div id="ref-Zhou+2023" class="csl-entry">
Zhou, C., Liu, P., Xu, P., Iyer, S., Sun, J., Mao, Y., … Levy, O. (2023). <a href="https://openreview.net/forum?id=KBMOKmX2he"><span>LIMA</span>: Less is more for alignment</a>. In <em>Thirty-seventh conference on neural information processing systems</em>.
</div>
<div id="ref-平石-中村2022" class="csl-entry">
平石界, and 中村大輝. (2022). <a href="https://www.jstage.jst.go.jp/article/jpssj/54/2/54_27/_article/-char/ja">心理学における再現性危機の10年―危機は克服されたのか，克服され得るのか―</a>. <em>科学哲学</em>, <em>54</em>(2), 27–50.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>これは <a href="https://www.microsoft.com/en-us/research/project/guidelines-for-human-ai-interaction/">Human-AI interaction におけるガイドライン</a> <span class="citation" data-cites="Amershi+2019">(Amershi et al., 2019)</span>, <span class="citation" data-cites="Bensal+2019">(Bansal et al., 2019)</span> でも明確にされている点である．この方向への試みの代表がベイズ機械学習，というわけではないが，筆者はベイズ機械学習の興隆は信頼のおける AI システムの構築にための極めて盤石な土台になるだろうと論じる．↩︎</p></li>
<li id="fn2"><p>本稿執筆後に，ほとんど同じ論調を，深層学習や基盤モデルを中心に，遥かに明瞭に述べた論文 <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> を見つけたので，賢明な読者はぜひこちらを参考にしていただきたい．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Broderick+2023">(Broderick et al., 2023, p. 2)</span> など．↩︎</p></li>
<li id="fn4"><p>この違いが「過学習」という現象に見舞われるかの違いでもある．“Fortunately, Bayesian approaches are not prone to this kind of overfitting since they average over, rather than fit, the parameters” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．↩︎</p></li>
<li id="fn5"><p>“for Bayesian researchers the main computational problem is integration, whereas for much of the rest of the community the focus is on optimization of model parameters.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 454)</span>．このように，その用いる手法も鮮やかに対照的に見えるが，積分は変分近似を通じて最適化問題としても解けるし，Lengevin 法や HMC などの最適化手法は積分問題を解ける．↩︎</p></li>
<li id="fn6"><p><span class="citation" data-cites="Broderick+2023">(Broderick et al., 2023)</span> が極めて説得的にこの点を指摘している．↩︎</p></li>
<li id="fn7"><p>合理的な信念の度合い (degree of belief) は確率の公理を満たす必要がある，という主張は <a href="https://en.wikipedia.org/wiki/Cox%27s_theorem">Cox の名前でも呼ばれる</a>．この点から，Bayes の定理は，帰納的推論の確率論的な拡張だとも捉えられる．“This justifies the use of subjective Bayesian probabilistic representations in artificial intelligence.” “Probabilistic modelling also has some conceptual advantages over alternatives because it is a normative theory for learning in artificially intelligent systems.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 453)</span>．↩︎</p></li>
<li id="fn8"><p>現状，日本にてベイズ機械学習を専業として研究を進めている人は <a href="https://emtiyaz.github.io/">Emtiyaz Khan</a> に限ると思われる．<span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 452)</span> でも “Probabilistic approaches have only recently become a mainstream approach to artificial intellifence, robotics, and machine learning.” と述べられている．↩︎</p></li>
<li id="fn9"><p>“The uncertainty quantification of prediction models (e.g., neural networks) is crucial for their adoption in many robotics applications. This is arguably as important as making accurate predictions, especially for safety-critical applications such as self-driving cars.” <span class="citation" data-cites="Chen+2023">(Chen et al., 2023)</span>．↩︎</p></li>
<li id="fn10"><p>モデルの予測結果に不確実性の定量化が伴われていたならば，モデルを信用出来ない場面で意思決定者がこれを信用したため責任があるのか，使用者には非難可能性がないのか，モデル設計者に過失があったと言えるのかの議論に，足場を与えることが出来るだろう．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Gal-Ghahramani2016">(Gal and Ghahramani, 2016)</span> も参照．↩︎</p></li>
<li id="fn12"><p>心理学においては「再現性問題が大きく注目される大きな契機となった「超能力論文」が出版されたのが 2011 年である」 <span class="citation" data-cites="平石-中村2022">(平石界 and 中村大輝, 2022)</span> ようである．計量経済学における <strong>信頼性革命</strong> <span class="citation" data-cites="Angrist-Pischke2010">(Angrist and Pischke, 2010)</span> は，再現性の危機の，もう一つの革新的な解決法である．↩︎</p></li>
<li id="fn13"><p>「それでは，信頼区間は不確実性の正しい定量化を与えないではないか！」ということになるが，その通りなのである．<img src="https://latex.codecogs.com/png.latex?P">-値を計算する過程とは，帰無仮説で条件付けているだけであり，データの関数でもある．<img src="https://latex.codecogs.com/png.latex?P">-値の確率変数としての分散が大きいほど，何回か同じ実験を繰り返せばすぐに小さな <img src="https://latex.codecogs.com/png.latex?P">-値が得られることになる．これは <a href="https://162348.github.io/posts/2023/数理法務/法律家のための統計数理2.html#sec-Bayes-problem"><strong>基準確率の誤謬</strong></a> と似ている．↩︎</p></li>
<li id="fn14"><p>“Confidence intervals suffer from an inverse inference problem that is not very different from that suffered by the NHSTP. In the NHSTP, the problem is in traversing the distance from the probability of the finding, given the null hypothesis, to the probability of the null hypothesis, given the finding.” <span class="citation" data-cites="Trafimow-Marks2015">(Trafimow and Marks, 2015)</span>↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Nuzzo2014">(Nuzzo, 2014)</span> には，Fisher が最初に用いてから，Neyman-Pearson 理論がこれを排除したものの，コミュニティが <img src="https://latex.codecogs.com/png.latex?P">-値を誤解して都合の良いように利用するようになるまでに至った歴史が説明されている．↩︎</p></li>
<li id="fn16"><p><span class="citation" data-cites="Murphy2022">(Murphy, 2022, p. 201)</span> の議論も参照．↩︎</p></li>
<li id="fn17"><p><span class="citation" data-cites="Efron1986">(Efron, 1986)</span> も示唆深い．↩︎</p></li>
<li id="fn18"><p><span class="citation" data-cites="Mohri-Hashimoto2024">(Mohri and Hashimoto, 2024)</span>, <span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024, p. 3)</span> 2.1節 なども指摘している．↩︎</p></li>
<li id="fn19"><p><span class="citation" data-cites="Novello+2024">(Novello et al., 2024)</span> では out-of-distribution detection, <span class="citation" data-cites="Mohri-Hashimoto2024">(Mohri and Hashimoto, 2024)</span> は LLM の hallucination への応用．↩︎</p></li>
<li id="fn20"><p>「筆者は，conformal prediction などの post-hoc な手法は，便利かも知れないが，「信頼区間」や「<img src="https://latex.codecogs.com/png.latex?P">-値」のような側面（第 2.3 節）も併せ持つのではないかと危惧しながら見ている．」と当初は書いていたが，どうもそう簡単な話ではないようである．<span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024)</span> を読んで思った．↩︎</p></li>
<li id="fn21"><p><span class="citation" data-cites="Papamarkou+2024">(Papamarkou et al., 2024, p. 5)</span> 3.4節．↩︎</p></li>
<li id="fn22"><p><span class="citation" data-cites="Wamg+2024">(Wang et al., 2024)</span> が最新のサーベイであるようだ．↩︎</p></li>
<li id="fn23"><p>Philipp Hennig <a href="https://youtu.be/TTo2kjrAuTo?si=QD_pqMkdLOl52OsR&amp;t=3703"><em>Probabilistic ML - Lecture 1 - Introduction</em></a> “Statistical Learning Theory is about Bayesian Reasoning when you don’t say out aloud what the prior is.”↩︎</p></li>
<li id="fn24"><p>これを <a href="https://en.wikipedia.org/wiki/Marginal_likelihood"><strong>証拠</strong></a> (model evidence) ともいう．↩︎</p></li>
<li id="fn25"><p>事前分布として非有限な測度を用いた場合など，例外もある．↩︎</p></li>
<li id="fn26"><p>“most conventional optimization-based machine-learning approaches have probabilistic analogues that handle uncertainty in a more principled manner.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 458)</span>．↩︎</p></li>
<li id="fn27"><p><span class="citation" data-cites="Neal-Hinton1998">(Neal and Hinton, 1998)</span> など．↩︎</p></li>
<li id="fn28"><p><span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 458)</span> はこれを <strong>モデルの属人化</strong> (personalization of models) と呼んでいる．↩︎</p></li>
<li id="fn29"><p><span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 453)</span> “probabilistic programming offers an elegant way of generalizing graphical models, allowing a much richer representation of models.”．↩︎</p></li>
<li id="fn30"><p>“More generally, Bayesian optimization is a special case of Bayesian numerical computation, which is re-emerging as a very active area of research, and includes topics such as solving ordinary differential equations and numerical integration.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 456)</span>．↩︎</p></li>
<li id="fn31"><p>“All commonly used lossless data compression algorithms (for example, <code>gzip</code>) can be viewed as probabilistic models of sequences of symbols.” <span class="citation" data-cites="Ghahramani2015">(Ghahramani, 2015, p. 456)</span>．↩︎</p></li>
<li id="fn32"><p><span class="citation" data-cites="Steinruecken+2015">(Steinruecken et al., 2015)</span> は記号列に対するノンパラメトリックモデルを改良することで，データ圧縮アルゴリズム <code>PPM</code> を改良した良い例である．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>AI</category>
  <guid>https://puniupa.github.io/posts/2024/AI/BAI.html</guid>
  <pubDate>Wed, 20 Mar 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>半導体入門</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/半導体/Semiconductor0.html</link>
  <description><![CDATA[ 




<section id="半導体入門" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="半導体入門"><span class="header-section-number">1</span> 半導体入門</h2>
<section id="半導体とは" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="半導体とは"><span class="header-section-number">1.1</span> 半導体とは？</h3>
<p>価電子帯と伝導帯の間の <a href="https://ja.wikipedia.org/wiki/%E3%83%90%E3%83%B3%E3%83%89%E3%82%AE%E3%83%A3%E3%83%83%E3%83%97"><strong>禁制帯</strong></a> (band gap) が十分に小さくて遷移を制御することが可能で，基底状態では価電子帯は完全に埋まっているものの伝導帯は空いているような物質を <a href="https://ja.wikipedia.org/wiki/%E5%8D%8A%E5%B0%8E%E4%BD%93"><strong>半導体</strong></a> という．<sup>1</sup></p>
<p>このような半導体では，熱や光，また外部電磁場などにより価電子が励起され，伝導帯に移る．この電子に加えて，価電子帯に生じた正孔も導電性に寄与する．<sup>2</sup> この <a href="https://ja.wikipedia.org/wiki/%E6%AD%A3%E5%AD%94">正孔</a> (hole) を擬似的に粒子と扱い，正孔の波動方程式を議論したのが <span class="citation" data-cites="Heisenberg1931">(Heisenberg, 1931)</span> である．</p>
</section>
<section id="半導体発見の歴史" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="半導体発見の歴史"><span class="header-section-number">1.2</span> 半導体発見の歴史</h3>
<p><span class="citation" data-cites="Faraday1833">(Faraday, 1833)</span> は，通常金属では温度の上昇と共に電気抵抗が増すが，硫化銀 Ag<sub>2</sub>S を初めとしたいくつかの物質では逆に電気抵抗が減少することを報告している．</p>
<p><span class="citation" data-cites="Braun1874">(Braun, 1874)</span> は <a href="https://ja.wikipedia.org/wiki/%E6%96%B9%E9%89%9B%E9%89%B1">方鉛鉱</a> PbS に電流を流そうとしても，単一方向にしか電流が流れない整流作用を示すことを発見し，<sup>3</sup> その後20世紀に入るとラジオに応用された．これが人類が初めて出会った半導体デバイスだったと言える <span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 1)</span>．<sup>4</sup></p>
<p>Braun はその後ブラウン管を発明し，こちらの業績により 1909 年にノーベル物理学賞を受賞する．</p>
<p><span class="citation" data-cites="Round1907">(Round, 1907)</span> はダイオードが電界を印加することで発行することがある (electroluminescence) ことを発見した．</p>
</section>
<section id="基本用語のまとめ" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="基本用語のまとめ"><span class="header-section-number">1.3</span> 基本用語のまとめ</h3>
<p>半導体素子には，トランジスタやダイオードなどがある．これらを配線によって相互接続したものが IC チップである．IC チップはシリコンのインゴットを円板状に切り出した <strong>ウエハ (wafer)</strong> 上に構築する．IC チップは平面的な印象を受けるが，実際は層に分けて構成されている，高度に立体的な構造物である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/半導体/Images/chip.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.hitachi-hightech.com/jp/ja/knowledge/semiconductor/room/about/ic.html">チップの断面構造</a></figcaption>
</figure>
</div>
<p>一つのウエハから多数のチップが作成され，その各単位を <a href="https://www.hitachi-hightech.com/jp/ja/knowledge/semiconductor/room/words.html#die"><strong>ダイ (die)</strong></a> ともいう．</p>
<p>しかし，普段我々が目にする <a href="https://www.hitachi-hightech.com/jp/ja/knowledge/semiconductor/room/about/ic.html">IC チップ</a> は <a href="https://www.toppan.com/ja/electronics/package/semicon/"><strong>パッケージ</strong></a> されたもの，で．IC チップそのもの（ダイそのもの）を目にすることはない．</p>
<p>32nm などというときは，ダイの大きさではなく，ダイ上の最小のトランジスタのサイズをいう．<sup>5</sup></p>
</section>
<section id="集積回路が出来るまで" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="集積回路が出来るまで"><span class="header-section-number">1.4</span> 集積回路が出来るまで</h3>
<p>まず回路を設計し，原版（マスター）を作る．これを <strong>フォトマスク (photomask)</strong> または <strong>レティクル (reticle)</strong> という．</p>
<p>これをウエハに転写するには，<a href="https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A9%E3%83%88%E3%83%AA%E3%82%BD%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3">フォトリソグラフィ</a> (Photolithography) を用いる．シリコンウエハの形成は，<a href="https://ja.wikipedia.org/wiki/%E3%83%81%E3%83%A7%E3%82%AF%E3%83%A9%E3%83%AB%E3%82%B9%E3%82%AD%E3%83%BC%E6%B3%95">Czochralski 法</a> <span class="citation" data-cites="Czochralski1918">(Czochralski, 1918)</span> による．<sup>6</sup></p>
<p>リソグラフィ自体は 1798 年からあり，<a href="https://ja.wikipedia.org/wiki/%E3%83%8B%E3%82%BB%E3%83%95%E3%82%A9%E3%83%BC%E3%83%AB%E3%83%BB%E3%83%8B%E3%82%A8%E3%83%97%E3%82%B9">Niépce</a> が <a href="https://ja.wikipedia.org/wiki/%E6%AD%B4%E9%9D%92">歴青</a> が感光剤の役割を果たすことを発見し，カメラの発明と同時に発見された．</p>
<p>エッチングに耐性のある感光剤を使えば，半導体デバイスの製造に応用できると気づいたのは <span class="citation" data-cites="Andrus1957">(Andrus, 1957)</span> である．この技術は半導体製造コストの 35 %を占めており，半導体市場の急成長はほとんどこの技術の進歩と両輪であると言う者も多い．<sup>7</sup></p>
<p>シリコン表面に酸化被膜を形成することで不純物原子の移動を阻止できることは <span class="citation" data-cites="Frosch-Derick1957">(Frosch and Derick, 1957)</span> が発見した．</p>
<p>以上の技術を用いて，最初の IC は <span class="citation" data-cites="Kilby1959">(Kilby, 1959)</span> が作った．<a href="https://en.wikipedia.org/wiki/Jack_Kilby">Jack Kilby</a> はその後 2000 年にノーベル物理学賞を受賞する．</p>
<p>しかし真に大量生産可能にし，半導体産業を大きくしたのは <span class="citation" data-cites="Noyce1959">(Noyce, 1959)</span> の発明であった．これは，現在主流の製法の基である <a href="https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%AC%E3%83%BC%E3%83%8A%E3%83%BC_%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9">Planar Process</a> <span class="citation" data-cites="Hoerni1960">(Hoerni, 1960)</span> で作られた．</p>
<p>実際に，どのように半導体チップを製造するかについては次節 2 で詳しく解説する．</p>
</section>
</section>
<section id="sec-manufacturing" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-manufacturing"><span class="header-section-number">2</span> 半導体の製造</h2>
<p>半導体の製造段階は，典型的には次の３つに大別される．</p>
<ol type="1">
<li>設計
<ol type="1">
<li>回路・レイアウト作成 (design)</li>
<li>フォトマスク (photomask) 作成</li>
</ol></li>
<li>前工程：次の３工程を繰り返ことで何層もの膜を積層する
<ol type="1">
<li>成膜 (deposition)</li>
<li>パターン転写 (exposure)</li>
<li>食刻 (etching)</li>
</ol></li>
<li>後工程
<ol type="1">
<li>角切り (dicing)</li>
<li>封入 (packaging)</li>
<li>品質検査 (inspection)</li>
</ol></li>
</ol>
<p><a href="https://www.hitachi-hightech.com/jp/ja/knowledge/semiconductor/room/manufacturing/process.html">日立の解説</a> も参照．</p>
<section id="設計工程" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="設計工程"><span class="header-section-number">2.1</span> 設計工程</h3>
<p>18に分類されることもある．</p>
<section id="回路レイアウト作成" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="回路レイアウト作成"><span class="header-section-number">2.1.1</span> 回路・レイアウト作成</h4>
<p><a href="https://ja.wikipedia.org/wiki/EDA_(%E5%8D%8A%E5%B0%8E%E4%BD%93)">EDA (Eleotron Design Automation)</a> を用いて設計を行う．</p>
</section>
</section>
<section id="前工程" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="前工程"><span class="header-section-number">2.2</span> 前工程</h3>
<section id="基本３工程" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="基本３工程"><span class="header-section-number">2.2.1</span> 基本３工程</h4>
<p>成膜，パターン転写，食刻の３工程を繰り返すことでウエハ上に構造を作っていくのであるが，その目的は大きく５つに分類出来る．</p>
<ol type="1">
<li><p>素子分離領域形成</p>
<p>酸化被膜により，素子間の絶縁を形成する．</p></li>
<li><p>well 形成</p>
<p>トランジスタの基盤となる領域に，食刻の代わりにイオンの添加する．</p></li>
<li><p>トランジスタ形成</p>
<p>ウエハ基盤上にトランジスタ素子を形成する．</p></li>
<li><p>電極形成</p>
<p>シリコン基盤上のトランジスタに届くように，すでに形成された層に穴 (contact hole) をあけ，導体を埋め込む．</p></li>
<li><p>配線層形成</p>
<p>基本３工程を繰り返すことで，トランジスタ層上を分厚い配線層で覆う．<sup>8</sup></p></li>
</ol>
</section>
<section id="異物検査と洗浄" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="異物検査と洗浄"><span class="header-section-number">2.2.2</span> 異物検査と洗浄</h4>
<p>ほとんどの工程間に，異物検査と洗浄の工程が必要になる．</p>
<p><a href="https://www.hitachi-hightech.com/jp/ja/products/semiconductor-manufacturing/cd-sem/inspection-solution/ls.html">日立の製品例</a>，<a href="https://www.hitachi-hightech.com/jp/ja/products/semiconductor-manufacturing/cd-sem/inspection-solution/is.html">ウェーハ欠陥検査</a></p>
</section>
<section id="表面酸化" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="表面酸化"><span class="header-section-number">2.2.3</span> 表面酸化</h4>
<p>熱酸化法では，酸素や高温のスチームを当てることで，表面に SiO<sub>2</sub> の酸化被膜を形成し，絶縁体として用いる．</p>
</section>
<section id="成膜" class="level4" data-number="2.2.4">
<h4 data-number="2.2.4" class="anchored" data-anchor-id="成膜"><span class="header-section-number">2.2.4</span> 成膜</h4>
</section>
<section id="パターン転写" class="level4" data-number="2.2.5">
<h4 data-number="2.2.5" class="anchored" data-anchor-id="パターン転写"><span class="header-section-number">2.2.5</span> パターン転写</h4>
<p>フォトマスク上から紫外線を当てることで，フォトレジストを感光させる．次の工程で感光部分のみを食刻することで，パターン該当部分のみに酸化被膜を残すことが出来る．</p>
</section>
<section id="食刻" class="level4" data-number="2.2.6">
<h4 data-number="2.2.6" class="anchored" data-anchor-id="食刻"><span class="header-section-number">2.2.6</span> 食刻</h4>
<p>現像後は，寸法計測を行う (ADI: After Development Inspection)．これは走査性電子顕微鏡 (SEM: Scanning Electron Microscope) である <a href="https://www.hitachi-hightech.com/jp/ja/knowledge/semiconductor/room/manufacturing/cd-sem.html">CD-SEM</a> などを用いて行う（<a href="https://www.hitachi-hightech.com/jp/ja/products/semiconductor-manufacturing/cd-sem/metrology-solution/">日立の製品例</a>）</p>
<p>これにより，正しくパターンが転写されていることが確認されたのち，食刻を行い，再び寸法計測を行う（AEI: After Etch Inspection などと呼び分ける）．</p>
<p>最後に，残ったフォトレジストはオゾンやプラズマにより灰化 (ashing) により除去する．</p>
<p>コンダクターエンチング（<a href="https://www.hitachi-hightech.com/jp/ja/products/semiconductor-manufacturing/dry-etch-systems/conductor/">日立の例</a>）</p>
</section>
<section id="イオン添加" class="level4" data-number="2.2.7">
<h4 data-number="2.2.7" class="anchored" data-anchor-id="イオン添加"><span class="header-section-number">2.2.7</span> イオン添加</h4>
<p>イオンを注入するとアモルファスとなるため，一度再加熱をして (annealing) 再結晶化する．</p>
</section>
</section>
<section id="後工程" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="後工程"><span class="header-section-number">2.3</span> 後工程</h3>
</section>
</section>
<section id="半導体デバイス" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="半導体デバイス"><span class="header-section-number">3</span> 半導体デバイス</h2>
<section id="構成要素" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="構成要素"><span class="header-section-number">3.1</span> 構成要素</h3>
<p>整流作用を示す接合には，ショットキー接合と pn 接合がある．</p>
</section>
<section id="双極から-mos-へ" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="双極から-mos-へ"><span class="header-section-number">3.2</span> 双極から MOS へ</h3>
<p>MOS (Metal-Oxide-Semiconductor) の３層構造を用いたトランジスタが採用される前は，双極トランジスタ (bipolar transistor) <span class="citation" data-cites="Shockley1949">(Shockley, 1949)</span> を用いた <a href="https://ja.wikipedia.org/wiki/Transistor-transistor_logic">TTL (Transistor-Transistor Logic)</a> 回路が主流であった．</p>
<p>しかしこれは，トランジスタの間の絶縁が難しく，密度を上げることが難しかった．そのような中で MOSFET (Metal-Oxide-Silicon Field-Effect Transistor) が開発された <span class="citation" data-cites="Kahng-Atalla1960">(Kahng and Atalla, 1960)</span>．MOSFET 技術は現代の半導体市場の 95% に関連する．<sup>9</sup></p>
<p>MOSFET は自己絶縁構造を持つため，これ以上の絶縁処理を必要とせず，双極トランジスタの 10 %の面積で済んだ．</p>
</section>
<section id="cmos-complementary-metal-oxide-semiconductor" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="cmos-complementary-metal-oxide-semiconductor"><span class="header-section-number">3.3</span> CMOS (Complementary Metal-Oxide-Semiconductor)</h3>
<p>MOS が初め採用した設計論理のは <a href="https://ja.wikipedia.org/wiki/NMOS%E3%83%AD%E3%82%B8%E3%83%83%E3%82%AF">NMOS</a> や <a href="https://ja.wikipedia.org/wiki/PMOS%E3%83%AD%E3%82%B8%E3%83%83%E3%82%AF">PMOS</a> であったが，常に直流電流を消費する必要があった．</p>
<p>しかし現代では，P 型と N 型の MOSFET を相補的に用いる CMOS が集積回路における支配的な技術である．</p>
<p>その秘訣は消費電力の少なさにあり，トランジスタの <img src="https://latex.codecogs.com/png.latex?0,1"> の切り替えの際に生じる電力（動的エネルギー）のみが消費される．<sup>10</sup></p>
<blockquote class="blockquote">
<p>CMOS技術は、当初アメリカの半導体業界では、当時より高性能だったNMOSを優先して見過ごされていた。しかし、CMOSは低消費電力であることから日本の半導体メーカーにいち早く採用され、さらに進化し、日本の半導体産業の隆盛につながった。<a href="https://ja.wikipedia.org/wiki/CMOS">CMOS</a></p>
</blockquote>
</section>
<section id="現代に汎在する半導体" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="現代に汎在する半導体"><span class="header-section-number">3.4</span> 現代に汎在する半導体</h3>
<p>計算機を構成する要素は多いが，Moore の法則により，多くが同一のチップの上に載ってしまい，不可視化が進んでいる．<sup>11</sup></p>
<section id="プロセッサ" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="プロセッサ"><span class="header-section-number">3.4.1</span> プロセッサ</h4>
<p>コンピュータの CPU と言ったときに，１枚のチップを意味するようになったのは 1971 年の <a href="https://ja.wikipedia.org/wiki/Intel_4004">Intel 4004</a> が初めてである．<sup>12</sup></p>
<p>3mm × 4mm のチップ上に 2300 の MOSFET を備え，大きな机ほどの CPU を備えた IBM コンピュータに匹敵する処理能力を持っていた．<sup>13</sup></p>
</section>
<section id="半導体メモリ" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="半導体メモリ"><span class="header-section-number">3.4.2</span> 半導体メモリ</h4>
<p>現代でメモリといえば <a href="https://ja.wikipedia.org/wiki/Random_Access_Memory">RAM (Random Access Memory)</a> を指す．本来はアクセスする順番に制約があった SAM (Sequential Access Memory) に対して作られた言葉であったが，現代では ROM (Read Only Memory) との対義語として理解されることが多いようである．</p>
<p><a href="https://ja.wikipedia.org/wiki/Static_Random_Access_Memory">SRAM (Static RAM)</a> は半導体メモリの一種であり，DRAM (Dynamic RAM) と比べて高速である．１ビットあたり６から８のトランジスタを使用したフリップフロップ回路により情報を記憶するため，定期的なリフレッシュが不要で高速な読み書きが可能であるが，集積率を上げることが出来ず，大容量メモリには向かない．<sup>14</sup></p>
<p><a href="https://ja.wikipedia.org/wiki/Dynamic_Random_Access_Memory">DRAM (Dynamic RAM)</a> <span class="citation" data-cites="Dennard1967">(Dennard, 1967)</span> はチップ内にコンデンサを備えており，１つのコンデンサで１ビットを表現する．これを読み出すのに１つのトランジスタ <a href="https://ja.wikipedia.org/wiki/MOSFET">MOSFET</a> を使うのみであるから，SRAM に比べて安価であるが，電荷は時間と共に散逸するため，定期的にリフレッシュする必要があり，消費電力は大きい．<sup>15</sup></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/半導体/Images/DRAM.png" class="img-fluid figure-img"></p>
<figcaption>From <span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 380)</span></figcaption>
</figure>
</div>
<p>DRAM と SRAM はいずれも揮発性である．不揮発性の半導体メモリには <a href="https://ja.wikipedia.org/wiki/%E3%83%95%E3%83%A9%E3%83%83%E3%82%B7%E3%83%A5%E3%83%A1%E3%83%A2%E3%83%AA">フィラッシュメモリ</a> がある．これには <a href="https://ja.wikipedia.org/wiki/%E6%B5%AE%E9%81%8A%E3%82%B2%E3%83%BC%E3%83%88MOSFET">蜉蝣ゲートMOSFET</a> という素子で捉えた電子により情報を記憶することで不揮発性を実現している．</p>
<p>フラッシュメモリには NAND 型と NOR 型があり，前者が主流である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://puniupa.github.io/posts/2024/半導体/Images/Memory_Revenue.png" class="img-fluid figure-img"></p>
<figcaption>Memory Revenue May, 2022. Source: <a href="https://omdia.tech.informa.com/pr/2023/mar/omdia-2022-a-record-year-for-semiconductors-that-feels-anything-but">Omedia</a></figcaption>
</figure>
</div>
</section>
<section id="graphics-processing-unit" class="level4" data-number="3.4.3">
<h4 data-number="3.4.3" class="anchored" data-anchor-id="graphics-processing-unit"><span class="header-section-number">3.4.3</span> Graphics Processing Unit</h4>
<p>描画を扱うチップは従来 VGA コントローラーと呼ばれていたが，1999 年には１つのチップで描画タスクの殆どをこなせるようになり，特に <a href="https://ja.wikipedia.org/wiki/NVIDIA_GeForce">NVIDIA GeForce</a> 256 は GPU という名称で売り出された．</p>
<p>こうして GPU は元来の 3D グラフィクスに特化した存在から，徐々に CPU を補完する多様なタスクに柔軟に対応できるように，プログラム可能で，大量のコアを持って並列計算可能なものに進化していった．近年の CPU はマルチコアのものが多いが，現在の GPU は 1000 コアを超えるものも多い．</p>
</section>
<section id="language-processing-unit" class="level4" data-number="3.4.4">
<h4 data-number="3.4.4" class="anchored" data-anchor-id="language-processing-unit"><span class="header-section-number">3.4.4</span> Language Processing Unit</h4>
<p><a href="https://wow.groq.com/lpu-inference-engine/">LPU</a> は，Google で <a href="https://ja.wikipedia.org/wiki/%E3%83%86%E3%83%B3%E3%82%BD%E3%83%AB%E3%83%BB%E3%83%97%E3%83%AD%E3%82%BB%E3%83%83%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%BB%E3%83%A6%E3%83%8B%E3%83%83%E3%83%88">TSU (Tensor Processing Unit)</a> のプロジェクトに初期から従事していたエンジニア <a href="https://wow.groq.com/jonathan-ross-every-word-matters/">Jonathan Ross</a> が 2016 年に創業したスタートアップ Groq の <a href="https://wow.groq.com/lpu-inference-engine/">登録商標</a> である．</p>
<p>Groq が <a href="https://www.prnewswire.com/news-releases/groq-selects-samsung-foundry-to-bring-next-gen-lpu-to-the-ai-acceleration-market-301900464.html">Samsung と協力して</a> 実現した LPU <span class="citation" data-cites="Abts+2022">(Abts et al., 2022)</span> は <a href="https://ja.wikipedia.org/wiki/EDRAM">eDRAM</a> を持つ <a href="https://ja.wikipedia.org/wiki/ASIC">ASIC (Application Specific Integrated Circuit)</a> であり，メモリのバンド幅と計算密度を増やし，逐次処理に特化することで特に言語処理に特化している．</p>
<p>2/20/2024 に <a href="https://groq.com/">デモ</a> を公開した．</p>
<p>LPU は推論に，GPU は学習に特化しており，相補的な役割を演じながら AI の進化を支えていく可能性がある．</p>
</section>
</section>
</section>
<section id="物理" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="物理"><span class="header-section-number">4</span> 物理</h2>
<section id="単体の半導体" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="単体の半導体"><span class="header-section-number">4.1</span> 単体の半導体</h3>
</section>
</section>
<section id="文献レビュー" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="文献レビュー"><span class="header-section-number">5</span> 文献レビュー</h2>
<p><span class="citation" data-cites="SemiconductorHandbook2023">(Rudan et al., 2023)</span> は辞典として使える．<span class="citation" data-cites="VanRossum2005">(Van Rossum, 2005)</span> は凝縮系物理学のハンドブック内でのエントリ．</p>
<section id="産業" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="産業"><span class="header-section-number">5.1</span> 産業</h3>
<p><span class="citation" data-cites="Miller2022">(Miller, 2022)</span> は Tufts 大学の <a href="https://www.christophermiller.net/">Chris Miller</a> による書籍．</p>
<p>和書としては，<span class="citation" data-cites="菊池正典2023">(菊池正典, 2023)</span> は <a href="https://ja.wikipedia.org/wiki/%E6%97%A5%E6%9C%AC%E9%9B%BB%E6%B0%97">NEC</a> 社員による半導体業界の解説書．</p>
</section>
<section id="教科書" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="教科書"><span class="header-section-number">5.2</span> 教科書</h3>
<p><span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012)</span> は浮遊ゲート MOSFET の発明者でもある <a href="https://ja.wikipedia.org/wiki/%E3%82%B5%E3%82%A4%E3%83%A2%E3%83%B3%E3%83%BB%E3%82%B8%E3%82%A3%E3%83%BC">Simon Min Sze（施敏）</a>の著作で，半導体分野で最も多く引用される教科書とされている．第２版なら <a href="https://www.kinokuniya.co.jp/f/dsg-01-9784782855508">和訳</a> もある．</p>
<p><span class="citation" data-cites="May-Spanos2006">(May and Spanos, 2006)</span> は California 大学 Davis 校の現学長 <a href="https://en.wikipedia.org/wiki/Gary_S._May">Gary May</a> と California 大学 Berkeley 校の <a href="https://en.wikipedia.org/wiki/Costas_Spanos">Costas Spanos</a> による書籍．</p>
<p><span class="citation" data-cites="May-Sze2003">(May and Sze, 2003)</span> もある．さらに発展的なものは <span class="citation" data-cites="Pierret2003">(Pierret, 2003)</span>．</p>
</section>
<section id="理論" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="理論"><span class="header-section-number">5.3</span> 理論</h3>
<p><span class="citation" data-cites="Kittel2018">(Kittel, 2018)</span> が固体物理学の標準的な入門書とされている．<span class="citation" data-cites="Boer-Pohl2018">(Böer and Pohl, 2018)</span> が特に半導体物理学の専門書になる．<span class="citation" data-cites="Huebener2019">(Huebener, 2019)</span> は前２つの橋渡しの役割をするが，重点は超伝導にある．</p>
</section>
<section id="その他" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="その他"><span class="header-section-number">5.4</span> その他</h3>
<p><span class="citation" data-cites="Richard2023">(Richard, 2023)</span> は SignalFire という VC に所属する著者による書．</p>
<p><span class="citation" data-cites="Lau2021">(Lau, 2021)</span> は <a href="https://ja.wikipedia.org/wiki/ASM%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%8A%E3%82%B7%E3%83%A7%E3%83%8A%E3%83%AB">AMS Pacific Technology</a> の <a href="https://www.semiconchina.org/en/870">技術アドバイザー</a> による書籍．</p>
<p><span class="citation" data-cites="Evstigneev2022">(Evstigneev, 2022)</span> はカナダ <a href="https://ja.wikipedia.org/wiki/%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%95%E3%82%A1%E3%83%B3%E3%83%89%E3%83%A9%E3%83%B3%E3%83%89%E3%83%A1%E3%83%A2%E3%83%AA%E3%82%A2%E3%83%AB%E5%A4%A7%E5%AD%A6">Memorial 大学</a> の <a href="https://www.physics.mun.ca/~mevstigneev/">凝縮系物理学者</a> が書いた．</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Abts+2022" class="csl-entry">
Abts, D., Kimmell, G., Ling, A., Kim, J., Boyd, M., Bitar, A., … Ross, J. (2022). <a href="https://doi.org/10.1145/3470496.3527405">A software-defined tensor streaming multiprocessor for large-scale machine learning</a>. In <em>Proceedings of the 49th annual international symposium on computer architecture</em>, pages 567–580. New York, NY, USA: Association for Computing Machinery.
</div>
<div id="ref-Andrus1957" class="csl-entry">
Andrus, J. (1957). <a href="https://patents.google.com/patent/US3122817A/en">Fabrication of semiconductor devices</a>. U.S. Patent 3,122,817A.
</div>
<div id="ref-Boer-Pohl2018" class="csl-entry">
Böer, K. W., and Pohl, U. W. (2018). <em><a href="https://link.springer.com/referencework/10.1007/978-3-319-69150-3">Semiconductor physics</a></em>. Springer Cham.
</div>
<div id="ref-Braun1874" class="csl-entry">
Braun, F. (1874). <a href="">Über die stromleitung durch schwefelmetalic</a>. <em>Annalen Der Physik and Chemie</em>, <em>153</em>(4), 556–563.
</div>
<div id="ref-Bridgman1925" class="csl-entry">
Bridgman, P. W. (1925). <a href="https://www.jstor.org/stable/25130058">Certain physical properties of single crystals of tungsten, antimony, bismuth, tellurium, cadmium, zinc, and tin</a>. <em>Proceedings of the American Academy of Arts and Sciences</em>, <em>60</em>(6), 305–383.
</div>
<div id="ref-Czochralski1918" class="csl-entry">
Czochralski, J. (1918). <a href="https://doi.org/10.1515/zpch-1918-9212">Ein neues verfahren zur messung der kristallisationsgeschwindigkeit der metalle</a>. <em>Zeitschrift Für Physikalische Chemie</em>, <em>92U</em>(1), 219–221.
</div>
<div id="ref-Dennard1967" class="csl-entry">
Dennard, R. H. (1967). <a href="https://patents.google.com/patent/US3387286A/en">Field effect transistor memory</a>. U.S. Patent 3,387,286A.
</div>
<div id="ref-Evstigneev2022" class="csl-entry">
Evstigneev, M. (2022). <em><a href="https://link.springer.com/book/10.1007/978-3-031-08458-4">Introduction to semiconductor physics and devices</a></em>. Springer Cham.
</div>
<div id="ref-Faraday1833" class="csl-entry">
Faraday, M. (1833). <a href="https://www.jstor.org/stable/107985">Experimental researches in electricity. Third series</a>. <em>Philosophical Transactions of the Royal Society of London</em>, <em>123</em>, 23–54.
</div>
<div id="ref-Frosch-Derick1957" class="csl-entry">
Frosch, C. J., and Derick, L. (1957). <a href="https://iopscience.iop.org/article/10.1149/1.2428650">Surface protection and selective masking during diffusion in silicon</a>. <em>Journal of the Electrochemical Society</em>, <em>104</em>(9), 547.
</div>
<div id="ref-Heisenberg1931" class="csl-entry">
Heisenberg, W. (1931). <a href="https://onlinelibrary.wiley.com/doi/10.1002/andp.19314020710">Zum paulischen ausschließungsprinzip</a>. <em>Annalen Der Physik</em>, <em>402</em>(7), 888–904.
</div>
<div id="ref-Hoerni1960" class="csl-entry">
Hoerni, J. A. (1960). <a href="https://ieeexplore.ieee.org/document/1472833">Planar silicon diodes and transistors</a>. In <em>1960 international electron devices meeting</em>.
</div>
<div id="ref-Hoff+1996" class="csl-entry">
Hoff, M. E., Faggin, F., Mazor, S., and Shima, M. (1996). <a href="https://ieeexplore.ieee.org/document/546561">The history of the 4004</a>. <em>IEEE Micro</em>, <em>16</em>(6), 10–20.
</div>
<div id="ref-Huebener2019" class="csl-entry">
Huebener, R. P. (2019). <em><a href="https://link-springer-com.utokyo.idm.oclc.org/book/10.1007/978-3-030-31420-0">Conductors, semiconductors, superconductors: An introduction to solid-state physics</a></em>. Springer Cham.
</div>
<div id="ref-Kahng-Atalla1960" class="csl-entry">
Kahng, D., and Atalla, M. M. (1960). <a href="https://www.worldscientific.com/doi/10.1142/9789814503464_0076">Silicon-silicon dioxide surface device</a>. <em>IRE Device Reserach Conference, Pittsburgh</em>.
</div>
<div id="ref-Kilby1959" class="csl-entry">
Kilby, J. S. (1959). <a href="https://patents.google.com/patent/US3138743A/en">Miniaturized electronic circuits</a>. U.S. Patent 3,138,743A.
</div>
<div id="ref-Kittel2018" class="csl-entry">
Kittel, C. (2018). <em><a href="https://www.wiley.com/en-ie/Kittel%27s+Introduction+to+Solid+State+Physics%2C+Global+Edition%2C+8th+Edition-p-9781119454168">Introduction to solid state physics</a></em>. John Wiley.
</div>
<div id="ref-Lau2021" class="csl-entry">
Lau, J. H. (2021). <em><a href="https://link.springer.com/book/10.1007/978-981-16-1376-0">Semiconductor advanced packaging</a></em>. Springer Singapore.
</div>
<div id="ref-Madelung1978" class="csl-entry">
Madelung, O. (1978). <em><a href="https://link.springer.com/book/10.1007/978-3-642-61885-7">Introduction to solid-state theory</a></em>,Vol. 2. Springer Berlin, Heidelberg.
</div>
<div id="ref-May-Spanos2006" class="csl-entry">
May, G. S., and Spanos, C. J. (2006). <em><a href="https://onlinelibrary.wiley.com/doi/book/10.1002/0471790281">Fundamentals of semiconductor manufacturing and process control</a></em>. John Wiley &amp; Sons.
</div>
<div id="ref-May-Sze2003" class="csl-entry">
May, G. S., and Sze, S. M. (2003). <em><a href="https://www.wiley.com/en-us/Fundamentals+of+Semiconductor+Fabrication-p-9780471232797">Fundamentals of semiconductor fabrication</a></em>. John Wiley &amp; Sons.
</div>
<div id="ref-Miller2022" class="csl-entry">
Miller, C. (2022). <em><a href="https://www.simonandschuster.com/books/Chip-War/Chris-Miller/9781982172008">Chip war: The fight for the world’s most critical technology</a></em>. Scribner.
</div>
<div id="ref-Noyce1959" class="csl-entry">
Noyce, R. N. (1959). <a href="https://patents.google.com/patent/US2981877A/en">Semiconductor device-and-lead structure</a>. U.S. Patent 2,981,877A.
</div>
<div id="ref-Patterson-Hennessy2014" class="csl-entry">
Patterson, D. A., and Hennessy, J. L. (2014). <em><a href="">Computer organization and design: The hardware/software interface</a></em>. Elsevier.
</div>
<div id="ref-Pierret2003" class="csl-entry">
Pierret, R. F. (2003). <em><a href="https://www.pearson.com/en-us/subject-catalog/p/advanced-semiconductor-fundamentals/P200000003285/9780130617927">Advanced semiconductor fundamentals</a></em>,Vol. VI. Pearson.
</div>
<div id="ref-Richard2023" class="csl-entry">
Richard, C. (2023). <em><a href="https://link.springer.com/book/10.1007/978-1-4842-8847-4">Understanding semiconductors: A technical guide for non-technical people</a></em>. Apress Berkeley.
</div>
<div id="ref-Round1907" class="csl-entry">
Round, H. J. (1907). <a href="https://www.worldscientific.com/doi/abs/10.1142/9789814503464_0116">A note on carborundum</a>. <em>Electrical World</em>, <em>19</em>, 309–310.
</div>
<div id="ref-SemiconductorHandbook2023" class="csl-entry">
Rudan, M., Brunetti, R., and Reggiani, S. (Eds.). (2023). <em><a href="https://link.springer.com/book/10.1007/978-3-030-79827-7">Springer handbook of semiconductor devices</a></em>. Springer Cham.
</div>
<div id="ref-Shockley1949" class="csl-entry">
Shockley, W. (1949). <a href="https://ieeexplore.ieee.org/document/6773080">The theory of <img src="https://latex.codecogs.com/png.latex?p">-<img src="https://latex.codecogs.com/png.latex?n"> junction in semiconductors and <img src="https://latex.codecogs.com/png.latex?p">-<img src="https://latex.codecogs.com/png.latex?n"> hunction transistors</a>. <em>The Bell System Technical Journal</em>, <em>28</em>(3), 435–489.
</div>
<div id="ref-Sze-Lee2012" class="csl-entry">
Sze, S. M., and Lee, M.-K. (2012). <em><a href="https://www.wiley.com/en-us/Semiconductor+Devices:+Physics+and+Technology,+3rd+Edition-p-9780470537947">Semiconductor devices: Physics and technology</a></em>. John Wiley &amp; Sons.
</div>
<div id="ref-VanRossum2005" class="csl-entry">
Van Rossum, M. (2005). <a href="https://doi.org/10.1016/B978-0-323-90800-9.00292-4">Integrated circuits</a>. In T. Chakraborty, editor, <em>Encyclopedia of condensed matter physics (second edition)</em>, pages 748–756. Oxford: Academic Press.
</div>
<div id="ref-Welker1952" class="csl-entry">
Welker, H. (1952). <a href="https://doi.org/10.1515/zna-1952-1110">Über neue halbleitende verbindungen</a>. <em>Zeitschrift Für Naturforschung A</em>, <em>7</em>(11), 744–749.
</div>
<div id="ref-菊池正典2023" class="csl-entry">
菊池正典. (2023). <em><a href="https://www.diamond.co.jp/book/9784478117118.html">半導体産業のすべて：世界の先端企業から日本メーカーの展望まで</a></em>. ダイヤモンド社.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><span class="citation" data-cites="Boer-Pohl2018">(Böer and Pohl, 2018, p. 4)</span>, <span class="citation" data-cites="Huebener2019">(Huebener, 2019, p. 73)</span> Chapter 6．金属が電気を通すのは，伝導帯が部分的に電子によって占められているためである．半導体は，（例えば温度を上げることなどにより）価電子帯の電子を簡単に伝導帯に移すことができるため，思い通りに金属のような振る舞いも，絶縁体のような振る舞いも引き出すことができる．しかし，半導体の自由電子は，金属に比べて極めて少なく．Boltzmann 統計に従い，金属の自由電子は Fermi 統計に従う <span class="citation" data-cites="Madelung1978">(Madelung, 1978, p. 17)</span>．一方で，金属の導電性は電子の密度とは関係がなく，金属内の電子密度は温度により一定である <span class="citation" data-cites="Madelung1978">(Madelung, 1978, p. 211)</span>．↩︎</p></li>
<li id="fn2"><p><span class="citation" data-cites="Huebener2019">(Huebener, 2019, p. 75)</span>．↩︎</p></li>
<li id="fn3"><p><span class="citation" data-cites="Huebener2019">(Huebener, 2019, p. 73)</span> 特に伝導体と半導体の境界部分で強く見られた．↩︎</p></li>
<li id="fn4"><p>現代では，このような接合を金属-半導体接合 (metal-semiconductor contact) または <a href="https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%E3%82%AD%E3%83%BC%E6%8E%A5%E5%90%88">Schottky 接合</a> といい，Ohmic 接合と対比する．↩︎</p></li>
<li id="fn5"><p><span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 27)</span> も参照．↩︎</p></li>
<li id="fn6"><p>一方で GaAs の形成は Bridgman 法 <span class="citation" data-cites="Bridgman1925">(Bridgman, 1925)</span> による．最も，この化合物が半導体であると発見されたのは <span class="citation" data-cites="Welker1952">(Welker, 1952)</span> になってようやくのことである．<span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 6)</span> も参照．↩︎</p></li>
<li id="fn7"><p><span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 6)</span> など．↩︎</p></li>
<li id="fn8"><p>今日の IC ではトランジスタ層は１層のみで，絶縁層で仕切ることで２〜８層の金属導体の配線層をその上に設ける． <span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 26)</span>．↩︎</p></li>
<li id="fn9"><p><span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 4)</span> など．↩︎</p></li>
<li id="fn10"><p><span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 41)</span>．↩︎</p></li>
<li id="fn11"><p><span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 379)</span>．↩︎</p></li>
<li id="fn12"><p><span class="citation" data-cites="Hoff+1996">(Hoff et al., 1996)</span> が開発者自ら歴史を振り返っている．当時は Intel も出来て３年しか経っていない新興企業であった．↩︎</p></li>
<li id="fn13"><p><span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 8)</span> など．↩︎</p></li>
<li id="fn14"><p><span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 379)</span>．↩︎</p></li>
<li id="fn15"><p><span class="citation" data-cites="Sze-Lee2012">(Sze and Lee, 2012, p. 8)</span>，<span class="citation" data-cites="Patterson-Hennessy2014">(Patterson and Hennessy, 2014, p. 379)</span> 参照．↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>半導体</category>
  <guid>https://puniupa.github.io/posts/2024/半導体/Semiconductor0.html</guid>
  <pubDate>Mon, 26 Feb 2024 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/半導体/Images/chip.png" medium="image" type="image/png" height="120" width="144"/>
</item>
<item>
  <title>LLM が真に社会に受け入れられるまで</title>
  <dc:creator>ぷに </dc:creator>
  <link>https://puniupa.github.io/posts/2024/AI/LLM.html</link>
  <description><![CDATA[ 




<section id="sec-LLaMA" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> LLaMA の一般公開とその影響</h1>
<p>Meta AI が <a href="https://about.fb.com/ja/news/2023/07/meta-and-microsoft-introduce-the-next-generation-of-llama/">7/18/2023</a> に LLM <a href="https://llama.meta.com/">LLaMA</a> <span class="citation" data-cites="Touvron+2023">(Touvron et al., 2023)</span> を公開した．そして API を通じて利用する形ではなく，そのモデルのウェイトが公開されたため，Stanford 大学の <a href="https://github.com/tatsu-lab/stanford_alpaca">Alpaca</a> など，モデルの改良と研究が促進されている．</p>
<p>特に事後調整のための公開データセットの整備が進んでおり，<a href="https://github.com/tatsu-lab/stanford_alpaca">Alpaca</a> では Self-Instruct <span class="citation" data-cites="Wang+2023-Self-Instruct">(Wang et al., 2023)</span> による効率的な alignment 技術が採用されている．</p>
<p>産業界でも影響は大きい．<a href="https://elyza.ai/">ELYZA</a> は <a href="https://elyza.ai/news/2023/12/27/130%E5%84%84%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%81%AE%E5%95%86%E7%94%A8%E5%88%A9%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA%E6%97%A5%E6%9C%AC%E8%AA%9Ellmelyza-j">12/27/2023</a> に日本語に特化した LLM である ELYZA-japanese-Llama-2-13b を公開している．<a href="https://stockmark.co.jp/">Stockmark</a> も <a href="https://stockmark.co.jp/news/20231027">10/27/2023</a> に Stockmark-13b を公開している．</p>
<p>いずれも，開発費と開発時間が大幅に圧縮されたという．<sup>1</sup></p>
<p>IBM は <a href="https://jp.newsroom.ibm.com/2023-09-12-Blog-Building-AI-for-business-IBM-Granite-foundation-models">9/12/2023</a> に LLM Granite を発表している．加えて，プラットフォーム <code>watsonx</code> も提供しており，その上で RAG など独自の事後調整を可能にしている．</p>
<p>IBM と Meta の２社が発起人となり，<a href="https://www.ibm.com/blogs/solutions/jp-ja/the-ai-alliance/">12/5/2023</a> に AI Alliance が発足し，オープンイノベーションを推進している．</p>
<p><a href="https://ja.stability.ai/stable-diffusion">Stable Diffusion</a> <span class="citation" data-cites="Rombach+2022">(Rombach et al., 2022)</span> もソースコードとウェイトが <a href="https://github.com/Stability-AI/stablediffusion">一般公開</a> されている．</p>
</section>
<section id="llm-の経済的影響" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> LLM の経済的影響</h1>
<p><span class="citation" data-cites="Tamkin+2021">(Tamkin et al., 2021)</span> は早い段階での OpenAI と Stanford 大学 <a href="https://hai.stanford.edu/">HAI</a> (Human-centered AI) との対談録である．</p>
<p>OpenAI はコード生成能力の経済的な影響を重要なアジェンダとしている <span class="citation" data-cites="Manning+2022">(Manning et al., 2022)</span>．</p>
<p>Open AI の <a href="https://openai.com/blog/openai-codex">Codex</a> <span class="citation" data-cites="Chen+2021">(Chen et al., 2021)</span> はプログラム言語を扱うトランスフォーマーであり，<a href="https://github.com/features/copilot">GitHub Copilot</a> の元となっている．これが社会に与える影響も，新たな評価フレームワークと共に提案されている <span class="citation" data-cites="Khlaaf+2022">(Khlaaf et al., 2022)</span>．</p>
<p>LLM の労働市場へのインパクトも推定している <span class="citation" data-cites="Eloundou+2023">(Eloundou et al., 2023)</span>．これによると，アメリカの労働者の 80% が，LLM の導入により少なくとも仕事の 10% に影響が生じるとしている．さらに全体の 20% は仕事の半分以上が影響を受けるとしている．</p>
</section>
<section id="世界モデルとしての基盤モデル" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> 世界モデルとしての基盤モデル</h1>
<section id="社会行動シミュレーターとしての-llm" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="社会行動シミュレーターとしての-llm"><span class="header-section-number">3.1</span> 社会行動シミュレーターとしての LLM</h2>
<p>社会的なシミュレーションを LLM 内で行うことで，社会科学やビジネスの場面での意思決定を支援することが期待されている．</p>
<p>LLM は人間の心の理論を理解し，その心情・意図を（ある程度）シミュレートすることが出来るようである <span class="citation" data-cites="Andreas2022">(Andreas, 2022)</span>．</p>
<p>LLM でのシミュレーションを通じて，社会科学的な知識を引き出そうとする試みもある <span class="citation" data-cites="Leng-Yuan2023">(Leng and Yuan, 2023)</span>．</p>
</section>
</section>
<section id="llm-と経済安全保障" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> LLM と経済安全保障</h1>
<section id="幻覚の防止" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="幻覚の防止"><span class="header-section-number">4.1</span> 幻覚の防止</h2>
<p>LLM が事実と異なる物語を生成することを <strong>幻覚</strong> (hallucination) と呼び，一部の応用では問題になることがある．</p>
<p>これを解決するにあたって，<strong>等角推測</strong> (conformal prediction) と組み合わせ，出力の不確実性を評価することで幻覚を防止する手法が提案されている <span class="citation" data-cites="Mohri-Hashimoto2024">(Mohri and Hashimoto, 2024)</span>．</p>
<p>一般に意思決定の場面において AI を活用するには，不確実性の定量化が必要不可欠である．</p>
<p>GPT-3 を Bayesian にし，自身の確証度合いを言表するように事後調整する研究が OpenAI で行われている <span class="citation" data-cites="Lin+2022">(Lin et al., 2022)</span>．</p>
</section>
<section id="ウォーターマーク" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="ウォーターマーク"><span class="header-section-number">4.2</span> ウォーターマーク</h2>
<p>ウォーターマークを開発することで，LLM から出力された文章であることを高確率で検出できるようにする方法が，統計的仮説検定の技術を応用して提案されている <span class="citation" data-cites="Kuditipudi+2023">(Kuditipudi et al., 2023)</span>．</p>
</section>
<section id="偽情報対策" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="偽情報対策"><span class="header-section-number">4.3</span> 偽情報対策</h2>
<p>生成 AI は，一国の政府が特定のプロパガンダを流布するための効果的な手段として選ばれることになる．その際の考え得る使用例と，それに対する対策が考えられてる <span class="citation" data-cites="Goldstein+2023">(Goldstein et al., 2023)</span>．</p>
<p>特に，2022 年に始まったロシアによるウクライナ侵攻は，最初の本格的な AI による情報戦と認識されつつある <span class="citation" data-cites="Sobchuk2024">(Sobchuk, 2024)</span>．</p>
<p>これに対する対抗手段として，ウクライナのスタートアップ <a href="https://www.osavul.cloud/">Osavul</a> や <a href="https://mantisanalytics.com/">Mantis Analytics</a> によって使われているのもやはり LLM である．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://mantisanalytics.com/"><img src="https://puniupa.github.io/static/Files/MantisAnalytics.png" class="img-fluid figure-img" alt="Mantis Analytics の製品のデモ（クリックで URL を開く）"></a></p>
<figcaption>Mantis Analytics の製品のデモ（クリックで URL を開く）</figcaption>
</figure>
</div>
</section>
<section id="開発規制" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="開発規制"><span class="header-section-number">4.4</span> 開発規制</h2>
<p><span class="citation" data-cites="Anderljung+2023">(Anderljung et al., 2023)</span> は先端的な AI を <a href="https://www.cnas.org/publications/commentary/frontier-ai-regulation-managing-emerging-risks-to-public-safety">Frontier AI</a> と呼び，これの開発過程におけるあるべき規制を模索している．監督当局に執行権を付与することやフロンティアAIモデルのライセンス制度などが議論されている．</p>
<p><span class="citation" data-cites="Shoker+2023">(Shoker et al., 2023)</span> は LLM と国家安全保障との関係を議論している．信頼構築措置 (CBMs: Confidence-Building Measures) とは，国家間の敵意を減少させることで，衝突のリスクを減らす措置の全般をいう．元々は冷戦時代に提案された概念であるが，これを LLM 開発に適用することが具体的に提案されている．</p>
</section>
<section id="生物学的脅威" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="生物学的脅威"><span class="header-section-number">4.5</span> 生物学的脅威</h2>
<p>LLM の登場により個人がエンパワーメントを受けており，生物学的脅威を作る障壁が低下していることは間違いない．</p>
<p><span class="citation" data-cites="Patwardhan+2024">(Patwardhan et al., 2024)</span> では，生物学的リスクに焦点を当てて，AI による安全リスク評価の手法と事前警鐘システムを模索している．この研究では，LLM によりリスクが増加するという統計的に有意義な証拠は得られていないが，この方面の研究の草分けとなっている．</p>
</section>
</section>
<section id="アラインメント問題" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> アラインメント問題</h1>
</section>



<div id="quarto-appendix" class="default"><section id="文献紹介" class="level1 appendix" data-number="6"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">6</span> 文献紹介</h2><div class="quarto-appendix-contents">

<p>大規模言語モデルとトランスフォーマーに関するより詳しい内容は，次の記事も参照：</p>
<div class="article-card-container">
    <div class="article-card">
        <a href="https://162348.github.io/posts/2024/Kernels/Deep2.html" target="_blank">
            <img src="https://162348.github.io/posts/2024/Kernels/Transformer_cut.png" alt="Article Image" class="article-image">
            <div class="article-content">
                <h3 class="article-title anchored" data-anchor-id="文献紹介">トランスフォーマー（深層生成モデル１）</h3>
                <p class="article-description">2023 年までの「基盤モデル」と呼ばれるような大規模な深層学習モデルは，ほとんど全て同一のアーキテクチャを持つ．これがトランスフォーマーである．その構造を，主に言語の分野に注目して概説する．最後に画像と動画の分野にも触れる．</p>
            </div>
        </a>
    </div>
</div>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Anderljung+2023" class="csl-entry">
Anderljung, M., Barnhart, J., Korinek, A., Leung, J., O’Keefe, C., Whittlestone, J., … Wolf, K. (2023). <a href="https://openai.com/research/frontier-ai-regulation">Frontier AI regulation: Managing emerging risks to public safety</a>. OpenAI.
</div>
<div id="ref-Andreas2022" class="csl-entry">
Andreas, J. (2022). <a href="https://arxiv.org/abs/2212.01681">Language models as agent models</a>.
</div>
<div id="ref-Chen+2021" class="csl-entry">
Chen, M., Tworek, J., Jun, H., Yuan, Q., Oliveira Pinto, H. P. de, Kaplan, J., … Zaremba, W. (2021). <a href="https://arxiv.org/abs/2107.03374">Evaluating large language models trained on code</a>.
</div>
<div id="ref-Eloundou+2023" class="csl-entry">
Eloundou, T., Manning, S., Mishkin, P., and Rock, D. (2023). <a href="https://openai.com/research/gpts-are-gpts">GPTs are GPTs: An early look at the labor market impact potential of large language models</a>.
</div>
<div id="ref-Goldstein+2023" class="csl-entry">
Goldstein, J. A., Sastry, G., Musser, M., DiResta, R., Gentzel, M., and Sedova, K. (2023). <a href="https://openai.com/research/forecasting-misuse">Generative language models and automated influence operations: Emerging threats and potential mitigations</a>.
</div>
<div id="ref-Khlaaf+2022" class="csl-entry">
Khlaaf, H., Mishkin, P., Achiam, J., Krueger, G., and Brundage, M. (2022). <a href="https://openai.com/research/a-hazard-analysis-framework-for-code-synthesis-large-language-models">A hazard analysis framework for code synthesis large language models</a>.
</div>
<div id="ref-Kuditipudi+2023" class="csl-entry">
Kuditipudi, R., Thickstun, J., Hashimoto, T., and Liang, P. (2023). <a href="https://arxiv.org/abs/2402.10978">Robust distortion-free watermarks for language models</a>.
</div>
<div id="ref-Leng-Yuan2023" class="csl-entry">
Leng, Y., and Yuan, Y. (2023). <a href="https://arxiv.org/abs/2312.15198">Do LLM agents exhibit social behavior?</a>
</div>
<div id="ref-Lin+2022" class="csl-entry">
Lin, S., Hilton, J., and Evans, O. (2022). <a href="https://openai.com/research/teaching-models-to-express-their-uncertainty-in-words">Teaching models to express their uncertainty in words</a>. In <em>Transactions on machine learning research</em>.
</div>
<div id="ref-Manning+2022" class="csl-entry">
Manning, S., Mishkin, P., Hadfield, G., Eloundou, T., and Eisne, E. (2022). <em>A research agenda for assessing the economic impacts of code generation models</em>. OpenAI. Retrieved from <a href="https://openai.com/research/economic-impacts">https://openai.com/research/economic-impacts</a>
</div>
<div id="ref-Mohri-Hashimoto2024" class="csl-entry">
Mohri, C., and Hashimoto, T. (2024). <a href="https://arxiv.org/abs/2402.10978">Language models with conformal factuality guarantees</a>.
</div>
<div id="ref-Patwardhan+2024" class="csl-entry">
Patwardhan, T., Liu, K., Markov, T., Chowdhury, N., Leet, D., Cone, N., … Mandry, A. (2024). <em>Building an early warning system for LLM-aided biological threat creation</em>. OpenAI. Retrieved from <a href="https://openai.com/research/building-an-early-warning-system-for-llm-aided-biological-threat-creation">https://openai.com/research/building-an-early-warning-system-for-llm-aided-biological-threat-creation</a>
</div>
<div id="ref-Rombach+2022" class="csl-entry">
Rombach, R., Blattmann, A., Lorenz, D., Esser, P., and Ommer, B. (2022). <a href="https://openaccess.thecvf.com/content/CVPR2022/html/Rombach_High-Resolution_Image_Synthesis_With_Latent_Diffusion_Models_CVPR_2022_paper.html">High-resolution image systhesis with latent diffusion models</a>. In <em>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR)</em>, pages 10684–10695.
</div>
<div id="ref-Shoker+2023" class="csl-entry">
Shoker, S., Reddie, A., Barrington, S., Booth, R., Brundage, M., Chahal, H., … Young, J. (2023). <a href="https://openai.com/research/confidence-building-measures-for-artificial-intelligence">Confidence-building measures for artificial intelligence: Workshop proceedings</a>.
</div>
<div id="ref-Sobchuk2024" class="csl-entry">
Sobchuk, M. (2024). <em><a href="https://www.globalgovernance.eu/publications/how-ukraine-uses-ai-to-fight-russian-information-operations">How ukraine uses AI to fight russian information operations</a></em>.
</div>
<div id="ref-Tamkin+2021" class="csl-entry">
Tamkin, A., Brundage, M., Clark, J., and Ganguli, D. (2021). <a href="https://arxiv.org/abs/2102.02503">Understanding the capabilities, limitations, and societal impact of large language models</a>.
</div>
<div id="ref-Touvron+2023" class="csl-entry">
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux, M.-A., Lacroix, T., … Lample, G. (2023). <a href="https://arxiv.org/abs/2302.13971">LLaMA: Open and efficient foundation language models</a>.
</div>
<div id="ref-Wang+2023-Self-Instruct" class="csl-entry">
Wang, Y., Kordi, Y., Mishra, S., Liu, A., Smith, N. A., Khashabi, D., and Hajishirzi, H. (2023). <a href="https://doi.org/10.18653/v1/2023.acl-long.754">Self-instruct: Aligning language models with self-generated instructions</a>. In A. Rogers, J. Boyd-Graber, and N. Okazaki, editors, <em>Proceedings of the 61st annual meeting of the association for computational linguistics (volume 1: Long papers)</em>, pages 13484–13508. Toronto, Canada: Association for Computational Linguistics.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://www.nikkei.com/article/DGXZQOUC268J80W3A221C2000000/">日経新聞 (2/19/2024)</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>AI</category>
  <category>Disinformation</category>
  <guid>https://puniupa.github.io/posts/2024/AI/LLM.html</guid>
  <pubDate>Tue, 20 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>インターネットとは AS 間が BGP で相互接続された裏路地である</title>
  <dc:creator>ぷに Draft</dc:creator>
  <link>https://puniupa.github.io/posts/2024/Tech/Internet.html</link>
  <description><![CDATA[ 




<p>登氏による総務省「西日本横断サイバーセキュリティ・グランプリ」講演資料 <a href="https://dnobori.cyber.ipa.go.jp/ppt/download/20230610_soumu/230610%20講演%20第1部%20(登)%20-%20配布資料その1%20-%20秘密の%20NTT%20電話局、フレッツ光、インターネット入門.pdf">登大遊 (2023) 秘密のNTT電話局，フレッツ光，およびインターネット入門(1)</a> という文献を，引用を交えながら，筆者が理解した事項を驚いた事項を紹介する．どんな内容が書いてあるかを概観してもらい，読者にも自分で興味のある箇所をぜひ読んでいただきたい．</p>
<section id="as-autonomous-system-とは何か" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="as-autonomous-system-とは何か"><span class="header-section-number">1</span> AS (Autonomous System) とは何か？</h2>
<blockquote class="blockquote">
<p>インターネットという連合体を形成する主体 1 つ 1 つを、「AS (Autonomous System: 自律システム) 」 という。自律システムとは、独立した領主・領土というような意味である。インターネット上の概念における主権を持っていて、他の主権者によって決して干渉されない。AS は、免許番号のような形で、整数の番号を持っている。これは AS 番号と呼ばれる。AS は、インターネット上の土地のような、「IP アドレス」というものを持っている。IP アドレスの種類としては、IPv4 と IPv6 とがある。バージョン 4 と 6 という意味である。西暦 1970 年代に成立した IPv4 アドレスというアドレス空間は、今となってはとても希少である。 <span class="citation" data-cites="登大遊2023">(登大遊, 2023, p. 32)</span></p>
</blockquote>
<p>登氏はASがインターネット空間の主権者の最大単位だと表現している．筆者は現実空間における法人と自然人を混ぜて1つの概念とした，インターネット空間上の抽象的存在と理解している．例として，ソフトイーサ社がASとして他のどのASと接続されているかを，「米国 Hurricane Electric 社 (激安 ISP) の <a href="https://bgp.he.net/AS59103#_graph4">BGP Toolkit のページ</a> 」（登さんの語彙）で確認出来る．</p>
<blockquote class="blockquote">
<p>自宅のコンピュータから、一度いずれかの AS の中にアクセスしたら (これは電話会社によって提供される。)、裏路地を通って世界中のすべての AS にアクセスできる。裏路地は、主体 (AS) がそれぞれ大変適当に提供し合っている。裏路地の責任主体は、極めて怪しい。裏路地を通るとき、色々な AS の土地を勝手に通過させてもらうことができる。何ら契約関係がなくても、通っていって良いのである。ただし、裏路地にはぬかるんでいる所があり、不快なこともあるが、無料なのでまあいいや、ということになる。この裏路地の存在が、インターネットの画期的な点である。 <span class="citation" data-cites="登大遊2023">(登大遊, 2023, p. 37)</span></p>
</blockquote>
<p>つまり，NTTやその販売代理店が，光フレッツというFTTH(Fiber To The Home)サービスを通じて提供してくれるのは，光ファイバーによる物理通信環境と，ASとの最初の接続を提供してくれる，というわけである．しかしインターネットはすべての主体が相対的であり，自らがAS割り当てを受けて，最寄のASとの通信を確立させたら（筆者はどうやれば良いのかまだわからないが），自分もインターネット空間においてISPと全く変わらない主体になる，というわけであるようだ．</p>
<p>光フレッツが電話会社から提供されているばかりに，一消費者としてはついつい強権的な存在を想定して，「インターネットは電話会社が接続させてくれるもの」と思いがちであるが，「インターネットのめんどくさいことを全部やってくれるスターターキット」以上の意味はないようである．この点が筆者にとって衝撃的であった．</p>
</section>
<section id="bgp-border-gateway-protocol-とは何か" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="bgp-border-gateway-protocol-とは何か"><span class="header-section-number">2</span> BGP (Border Gateway Protocol) とは何か</h2>
<p>インターネット空間に存在する唯一のルールともいうべき，P2Pにおける通信規約である．登氏は「国境接続儀礼」と訳している．</p>
<blockquote class="blockquote">
<p>BGP を少し悪用すると、勝手に他の主体の IP アドレスを使うと宣言して、その IP アドレス宛の通信を全世界から全部引っ張り込むこともできてしまう。セキュリティ的に大変危険であるが、これはなかなか防げないので、問題になっている。 AS は国際社会における最上位の主権者であり、BGP は国際社会における事実上の法 (国際法) である。ある AS が BGP の法に違反したからといって取り締まられることがない (より上位の主体がないため)。ただし、「あの AS は法を遵守していない危険な AS だ。」 (例: Google の Public DNS サーバーの IP アドレス 8.8.8.8 を他の AS が勝手に名乗った) ということで、すぐに世界中に風評が伝わり、他のすべての AS から村八分にされることで、事実上隔離され、危険は回避される。インターネットにおける IP アドレスに基づく通信というのは、このように、大変にいい加減な仕組みである。 このあたりのインターネット基礎中の基礎を知らずに、日本警察のサイバー犯罪対策課などは、IP アドレスについては、Whois 台帳 (どの IP アドレスがどの組織に割当てられているかを管理する台帳) の記載を信用していて、事件に使われた IP アドレスが分かれば確実に通信者 (少なくともプロバイダ) が特定できるなどと誤解していて、これを疑うことをしない。Whois 台帳と、実際に誰が IP アドレスを使っていたかは、全く無関係である。少し自ら BGP をやってみればすぐに分かることである。ある土地で殺人事件が起きたときに、登記簿を見て、土地の所有者にお前が犯人だと言うようなものである。土地の登記簿と、その事件があったときに土地に誰がいたのかは、無関係である。ちなみに、日本の警察がサイバー、サイバーといっておきながら、サイバー空間の根本部分の基礎知識が分かっていないことは、無理もないことである。警察組織の中に通信技術やインターネット技術といったものの内側の知識習得や試行錯誤を行なう環境がこれまで存在しなかったからである。しかし、これからは真剣に勉強する意欲があるようなので、未来は明るい。 <span class="citation" data-cites="登大遊2023">(登大遊, 2023, pp. 37–38)</span></p>
</blockquote>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-登大遊2023" class="csl-entry">
登大遊. (2023). <em><a href="https://dnobori.cyber.ipa.go.jp/ppt/download/20230610_soumu/230610%20講演%20第1部%20(登)%20-%20配布資料その1%20-%20秘密の%20NTT%20電話局、フレッツ光、インターネット入門.pdf">秘密のNTT電話局，フレッツ光，およびインターネット入門(1)</a></em>.
</div>
</div></section></div> ]]></description>
  <category>Tech</category>
  <guid>https://puniupa.github.io/posts/2024/Tech/Internet.html</guid>
  <pubDate>Fri, 08 Dec 2023 00:00:00 GMT</pubDate>
  <media:content url="https://puniupa.github.io/posts/2024/Tech/Internet_cover.png" medium="image" type="image/png" height="95" width="144"/>
</item>
</channel>
</rss>
